<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Density strips</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for denstrip {denstrip}"><tr><td>denstrip {denstrip}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Density strips</h2>

<h3>Description</h3>

<p>The density strip illustrates a univariate distribution as a shaded
rectangular strip, whose darkness at a point is proportional to the
probability density.  The strip is darkest at the maximum density and
fades into the background at the minimum density.  It may be used to generalise
the common point-and-line drawing of a point and interval estimate,
by representing the entire posterior or predictive distribution of the
estimate.  This function adds a density strip to an existing plot. 
</p>


<h3>Usage</h3>

<pre>
denstrip(x, dens, at, width, horiz=TRUE, colmax, colmin="white",
         scale=1, gamma=1, ticks=NULL, tlen=1.5, twd, tcol, mticks=NULL,
         mlen=1.5, mwd, mcol, lattice=FALSE, ...)
panel.denstrip(...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p> Either the vector of points at which the density is
evaluated (if <code>dens</code> supplied), or a sample from the distribution
(if <code>dens</code> not supplied). </p>
</td></tr>
<tr valign="top"><td><code>dens</code></td>
<td>
<p> Density at <code>x</code>. If <code>dens</code> is not supplied,
the density of the sample <code>x</code> is estimated by kernel density
estimation, using <code><a href="../../stats/html/density.html">density</a>(x,...)</code>.</p>
</td></tr>
<tr valign="top"><td><code>at</code></td>
<td>
<p> Position of the centre of the strip on the y-axis (if
<code>horiz=TRUE</code>) or the x-axis (if <code>horiz=FALSE</code>).  </p>
</td></tr>
<tr valign="top"><td><code>width</code></td>
<td>
<p> Thickness of the strip, that is, the length of its
shorter dimension.  Defaults to 1/30 of the axis range. </p>
</td></tr>
<tr valign="top"><td><code>horiz</code></td>
<td>
<p> Draw the strip horizontally (<code>TRUE</code>) or vertically (<code>FALSE</code>).</p>
</td></tr>
<tr valign="top"><td><code>colmax</code></td>
<td>
<p> Colour at the maximum density, either as a built-in R
colour name (one of <code><a href="../../grDevices/html/colors.html">colors</a>()</code>) or an RGB hex
value. Defaults to <code>par("fg")</code> which is normally 
<code>"black"</code>, or <code>"#000000"</code>. Or in <span class="pkg">lattice</span>, defaults   
to <code>trellis.par.get("add.line")$col</code>.</p>
</td></tr>
<tr valign="top"><td><code>colmin</code></td>
<td>
<p> Colour to shade the minimum density, likewise. 
Defaults to &quot;white&quot;.  If this is set to <code>"transparent"</code>,
and the current graphics device supports transparency (see <code><a href="../../grDevices/html/rgb.html">rgb</a></code>), then
overlapping strips will merge smoothly. </p>
</td></tr>
<tr valign="top"><td><code>scale</code></td>
<td>
<p> Proportion of <code>colmax</code> to shade the maximum
density, for example <code>scale=0.5</code> with <code>colmax="black"</code> for
a mid-grey colour.  </p>
</td></tr>
<tr valign="top"><td><code>gamma</code></td>
<td>
<p> Gamma correction to apply to the colour palette.
The default of 1 should give an approximate perception of
darkness proportional to density, but this may need to be adjusted
for different displays. Values of <code>gamma</code> greater than 1
produce colours weighted towards the lighter end, and values of
between 0 and 1 produce darker colours.
</p>
</td></tr>
<tr valign="top"><td><code>ticks</code></td>
<td>
<p> Vector of <code>x</code>-positions on the strip to draw tick marks, or <code>NULL</code> for no ticks. </p>
</td></tr>
<tr valign="top"><td><code>tlen</code></td>
<td>
<p> Length of these tick marks relative to the strip width. </p>
</td></tr>
<tr valign="top"><td><code>twd</code></td>
<td>
<p> Line thickness of these marks (defaults to
<code><a href="../../graphics/html/par.html">par</a>("lwd")</code>, or in <span class="pkg">lattice</span>, to
</p>
<p><code><a href="../../lattice/html/trellis.par.get.html">trellis.par.get</a>("add.line")$lwd*2</code>.). </p>
</td></tr>
<tr valign="top"><td><code>tcol</code></td>
<td>
<p>Colour of the tick marks. Defaults to <code>colmax</code>.</p>
</td></tr>
<tr valign="top"><td><code>mticks</code></td>
<td>
 <p><code>x</code>-position to draw a thicker tick mark or tick
marks (for example, at the mean or median). </p>
</td></tr>
<tr valign="top"><td><code>mlen</code></td>
<td>
<p> Length of this mark relative to the strip width. </p>
</td></tr>
<tr valign="top"><td><code>mwd</code></td>
<td>
<p> Line thickness of this mark (defaults to
<code><a href="../../graphics/html/par.html">par</a>("lwd")*2</code>, or in <span class="pkg">lattice</span>, to    
<code><a href="../../lattice/html/trellis.par.get.html">trellis.par.get</a>("add.line")$lwd*2</code>.). </p>
</td></tr>
<tr valign="top"><td><code>mcol</code></td>
<td>
<p>Colour of this mark. Defaults to <code>colmax</code>.</p>
</td></tr>
<tr valign="top"><td><code>lattice</code></td>
<td>
<p>Set this to <code>TRUE</code> to make <code><a href="denstrip.html">denstrip</a></code>
a <span class="pkg">lattice</span> panel function instead of a base graphics function. <br />
<code>panel.denstrip(x,...)</code> is equivalent to
<code>denstrip(x, lattice=TRUE, ...)</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional arguments supplied to <code><a href="../../stats/html/density.html">density</a>(x,...)</code>, if
the density is being estimated.  For example, <code>bw</code> to change
the bandwidth of the kernel. </p>
</td></tr>
</table>


<h3>In other software</h3>

<p>In OpenBUGS (<a href="http://www.openbugs.net">http://www.openbugs.net</a>) density strips are
available via the Inference/Compare menu. 
</p>
<p>See this blog post:
<a href="http://blogs.sas.com/content/graphicallyspeaking/2012/11/03/density-strip-plot/">http://blogs.sas.com/content/graphicallyspeaking/2012/11/03/density-strip-plot/</a>,
for density strips in SAS. 
</p>


<h3>Author(s)</h3>

<p> Christopher Jackson &lt;chris.jackson@mrc-bsu.cam.ac.uk&gt; </p>


<h3>References</h3>

<p> Jackson, C. H.  (2008) Displaying uncertainty with
shading. <em>The American Statistician</em>, 62(4):340-347. 
</p>


<h3>See Also</h3>

 <p><code><a href="denstrip.legend.html">denstrip.legend</a></code>, <code><a href="densregion.html">densregion</a></code>.</p>


<h3>Examples</h3>

<pre>
## Illustrate a known standard normal distribution
## Various settings to change the look of the plot

x &lt;- seq(-4, 4, length=10000)
dens &lt;- dnorm(x)
plot(x, xlim=c(-5, 5), ylim=c(-5, 5), xlab="x", ylab="x", type="n")
denstrip(x, dens, at=0) # default width 
denstrip(x, dens, width=0.5, at=0) 
denstrip(x, dens, at=-4, ticks=c(-2, 0, 2)) 
denstrip(x, dens, at=-3, ticks=c(-2, 2), mticks=0) 
denstrip(x, dens, at=-2, ticks=c(-2, 2), mticks=0, mlen=3, 
         mwd=4, colmax="#55AABB") 
denstrip(x, dens, at=1, ticks=c(-2, 2), tlen=3, twd=3) 
denstrip(x, dens, at=-4, ticks=c(-2, 2), mticks=0, colmax="darkgreen", 
         horiz=FALSE)
x &lt;- rnorm(1000) # Estimate the density
denstrip(x, width=0.2, at=-3, ticks=c(-2, 2), mticks=0, colmax="darkgreen",
         horiz=FALSE)
denstrip(x, at=2, width=0.5, gamma=2.2) 
denstrip(x, at=3, width=0.5, gamma=1/2.2) 

### Specifying colour of minimum density 
par(bg="lightyellow")
plot(x, xlim=c(-5, 5), ylim=c(-5, 5), xlab="x", ylab="x", type="n")
x &lt;- seq(-4, 4, length=10000)
dens &lt;- dnorm(x)
## Equivalent ways of drawing same distribution 
denstrip(x, dens, at=-1, ticks=c(-2, 2), mticks=0, colmax="darkmagenta")
denstrip(x, dens, at=-2, ticks=c(-2, 2), mticks=0, colmax="darkmagenta",
         colmin="lightyellow")
## ...though the next only works if graphics device supports transparency 
denstrip(x, dens, at=-3, ticks=c(-2, 2), mticks=0, colmax="darkmagenta",
         colmin="transparent")
denstrip(x, dens, at=-4, ticks=c(-2, 2), mticks=0, colmax="#8B008B", colmin="white")

## Alternative to density regions (\link{densregion.survfit}) for
## survival curves - a series of vertical density strips with no
## interpolation

if (requireNamespace("survival", quietly=TRUE)){

library(survival)
fit &lt;- survfit(Surv(time, status) ~ 1, data=aml, conf.type="log-log")
plot(fit, col=0)
lse &lt;- (log(-log(fit$surv)) - log(-log(fit$upper)))/qnorm(0.975)
n &lt;- length(fit$time)
lstrip &lt;- fit$time - (fit$time-c(0,fit$time[1:(n-1)])) / 2
rstrip &lt;- fit$time + (c(fit$time[2:n], fit$time[n])-fit$time) / 2
for (i in 1:n) { 
    y &lt;- exp(-exp(qnorm(seq(0,1,length=1000)[-c(1,1000)], 
                        log(-log(fit$surv))[i], lse[i])))
    z &lt;- dnorm(log(-log(y)), log(-log(fit$surv))[i], lse[i])
    denstrip(y, z, at=(lstrip[i]+rstrip[i])/2,
                 width=rstrip[i]-lstrip[i],
                 horiz=FALSE, colmax="darkred")
}
par(new=TRUE)
plot(fit, lwd=2)

}

## Use for lattice graphics (first example from help(xyplot))

library(lattice)
Depth &lt;- equal.count(quakes$depth, number=8, overlap=.1)
xyplot(lat ~ long | Depth, data = quakes,
       panel = function(x, y) { 
           panel.xyplot(x, y)
           panel.denstrip(x, horiz=TRUE, at=-10, ticks=mean(x))
           panel.denstrip(y, horiz=FALSE, at=165, ticks=mean(y))
       } 
       )

## Lattice example data: heights of singing voice types

bwplot(voice.part ~ height, data=singer, xlab="Height (inches)",
       panel=panel.violin, xlim=c(50,80))
bwplot(voice.part ~ height, data=singer, xlab="Height (inches)",
       panel = function(x, y) {
           xlist &lt;- split(x, factor(y))
           for (i in seq(along=xlist))
               panel.denstrip(x=xlist[[i]], at=i)
       },
       xlim=c(50,80)
       )
</pre>

<hr /><div style="text-align: center;">[Package <em>denstrip</em> version 1.5.4 <a href="00Index.html">Index</a>]</div>
</body></html>
