<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Tidying methods for seasonal decompositions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for decompose_tidiers {broom}"><tr><td>decompose_tidiers {broom}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Tidying methods for seasonal decompositions</h2>

<h3>Description</h3>

<p>These tidiers provide an <code>augment</code> method for the results of a seasonal
decomposition with <code><a href="../../stats/html/decompose.html">decompose</a></code> or
<code><a href="../../stats/html/stl.html">stl</a></code>.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'decomposed.ts'
augment(x, ...)

## S3 method for class 'stl'
augment(x, weights = TRUE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>An object of class <code>"stl"</code> or <code>"decomposed.ts"</code>,
resulting from a call to <code><a href="../../stats/html/decompose.html">decompose</a></code> or
<code><a href="../../stats/html/stl.html">stl</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Extra arguments. Unused.</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
<p>Whether to include the robust weights in the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>augment</code> method returns the computed seasonal and trend components,
as well as the &quot;remainder&quot; term and the seasonally adjusted (or
&quot;deseasonalised&quot;) series.
</p>


<h3>Value</h3>

<p>The <code>augment</code> method returns a tidy data frame with the following
columns:
</p>

<dl>
<dt><code>.seasonal</code></dt><dd><p>The seasonal component of the decomposition.</p>
</dd>
<dt><code>.trend</code></dt><dd><p>The trend component of the decomposition.</p>
</dd>
<dt><code>.remainder</code></dt><dd><p>The remainder, or &quot;random&quot; component of the
decomposition.</p>
</dd>
<dt><code>.weight</code></dt><dd><p>The final robust weights (<code>stl</code> only).</p>
</dd>
<dt><code>.seasadj</code></dt><dd><p>The seasonally adjusted (or &quot;deseasonalised&quot;)
series.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Aaron Jacobs
</p>


<h3>See Also</h3>

<p><code><a href="../../stats/html/decompose.html">decompose</a></code>, <code><a href="../../stats/html/stl.html">stl</a></code>
</p>


<h3>Examples</h3>

<pre>

# Time series of temperatures in Nottingham, 1920-1939:
nottem

# Perform seasonal decomposition on the data with both decompose
# and stl:
d1 &lt;- stats::decompose(nottem)
d2 &lt;- stats::stl(nottem, s.window = "periodic", robust = TRUE)

# Compare the original series to its decompositions.

cbind(broom::tidy(nottem), broom::augment(d1),
      broom::augment(d2))

# Visually compare seasonal decompositions in tidy data frames.

library(tibble)
library(dplyr)
library(tidyr)
library(ggplot2)

decomps &lt;- tibble(
    # Turn the ts objects into data frames.
    series = list(broom::tidy(nottem), broom::tidy(nottem)),
    # Add the models in, one for each row.
    decomp = c("decompose", "stl"),
    model = list(d1, d2)
) %&gt;%
    rowwise() %&gt;%
    # Pull out the fitted data using broom::augment.
    mutate(augment = list(broom::augment(model))) %&gt;%
    ungroup() %&gt;%
    # Unnest the data frames into a tidy arrangement of
    # the series next to its seasonal decomposition, grouped
    # by the method (stl or decompose).
    group_by(decomp) %&gt;%
    unnest(series, augment) %&gt;%
    mutate(index = 1:n()) %&gt;%
    ungroup() %&gt;%
    select(decomp, index, x, adjusted = .seasadj)

ggplot(decomps) +
    geom_line(aes(x = index, y = x), colour = "black") +
    geom_line(aes(x = index, y = adjusted, colour = decomp,
                  group = decomp))

</pre>

<hr /><div style="text-align: center;">[Package <em>broom</em> version 0.4.5 <a href="00Index.html">Index</a>]</div>
</body></html>
