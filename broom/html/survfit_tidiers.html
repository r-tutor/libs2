<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: tidy survival curve fits</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for survfit_tidiers {broom}"><tr><td>survfit_tidiers {broom}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>tidy survival curve fits</h2>

<h3>Description</h3>

<p>Construct tidied data frames showing survival curves over time.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'survfit'
tidy(x, ...)

## S3 method for class 'survfit'
glance(x, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>&quot;survfit&quot; object</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>extra arguments, not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>glance</code> does not work on multi-state survival curves,
since the values <code>glance</code> outputs would be calculated for each state.
<code>tidy</code> does work for multi-state survival objects, and includes a
<code>state</code> column to distinguish between them.
</p>


<h3>Value</h3>

<p>All tidying methods return a data.frame without rownames, whose
structure depends on the method chosen.
</p>
<p><code>tidy</code> returns a row for each time point, with columns
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>time</code></td>
<td>
<p>timepoint</p>
</td></tr>
<tr valign="top"><td><code>n.risk</code></td>
<td>
<p>number of subjects at risk at time t0</p>
</td></tr>
<tr valign="top"><td><code>n.event</code></td>
<td>
<p>number of events at time t</p>
</td></tr>
<tr valign="top"><td><code>n.censor</code></td>
<td>
<p>number of censored events</p>
</td></tr>
<tr valign="top"><td><code>estimate</code></td>
<td>
<p>estimate of survival or cumulative incidence rate when multistate</p>
</td></tr>
<tr valign="top"><td><code>std.error</code></td>
<td>
<p>standard error of estimate</p>
</td></tr>
<tr valign="top"><td><code>conf.high</code></td>
<td>
<p>upper end of confidence interval</p>
</td></tr>
<tr valign="top"><td><code>conf.low</code></td>
<td>
<p>lower end of confidence interval</p>
</td></tr>
<tr valign="top"><td><code>state</code></td>
<td>
<p>state if multistate survfit object inputted</p>
</td></tr>
<tr valign="top"><td><code>strata</code></td>
<td>
<p>strata if stratified survfit object inputted</p>
</td></tr>
</table>
<p><code>glance</code> returns one-row data.frame with the columns
displayed by <code><a href="../../survival/html/print.survfit.html">print.survfit</a></code>
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>records</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr valign="top"><td><code>n.max</code></td>
<td>
<p>n.max</p>
</td></tr>
<tr valign="top"><td><code>n.start</code></td>
<td>
<p>n.start</p>
</td></tr>
<tr valign="top"><td><code>events</code></td>
<td>
<p>number of events</p>
</td></tr>
<tr valign="top"><td><code>rmean</code></td>
<td>
<p>Restricted mean (see <a href="../../survival/html/print.survfit.html">print.survfit</a>)</p>
</td></tr>
<tr valign="top"><td><code>rmean.std.error</code></td>
<td>
<p>Restricted mean standard error</p>
</td></tr>
<tr valign="top"><td><code>median</code></td>
<td>
<p>median survival</p>
</td></tr>
<tr valign="top"><td><code>conf.low</code></td>
<td>
<p>lower end of confidence interval on median</p>
</td></tr>
<tr valign="top"><td><code>conf.high</code></td>
<td>
<p>upper end of confidence interval on median</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre>

if (require("survival", quietly = TRUE)) {
    cfit &lt;- coxph(Surv(time, status) ~ age + sex, lung)
    sfit &lt;- survfit(cfit)
    
    head(tidy(sfit))
    glance(sfit)
    
    library(ggplot2)
    ggplot(tidy(sfit), aes(time, estimate)) + geom_line() +
        geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha=.25)
    
    # multi-state
    fitCI &lt;- survfit(Surv(stop, status * as.numeric(event), type = "mstate") ~ 1,
                  data = mgus1, subset = (start == 0))
    td_multi &lt;- tidy(fitCI)
    head(td_multi)
    tail(td_multi)
    ggplot(td_multi, aes(time, estimate, group = state)) +
        geom_line(aes(color = state)) +
        geom_ribbon(aes(ymin = conf.low, ymax = conf.high), alpha = .25)
 
    # perform simple bootstrapping
    library(dplyr)
    bootstraps &lt;- lung %&gt;% bootstrap(100) %&gt;%
        do(tidy(survfit(coxph(Surv(time, status) ~ age + sex, .))))
    
    ggplot(bootstraps, aes(time, estimate, group = replicate)) +
        geom_line(alpha = .25)
    
    bootstraps_bytime &lt;- bootstraps %&gt;% group_by(time) %&gt;%
        summarize(median = median(estimate),
                  low = quantile(estimate, .025),
                  high = quantile(estimate, .975))
    
    ggplot(bootstraps_bytime, aes(x = time, y = median)) + geom_line() +
        geom_ribbon(aes(ymin = low, ymax = high), alpha = .25)
 
    # bootstrap for median survival
    glances &lt;- lung %&gt;%
        bootstrap(100) %&gt;%
        do(glance(survfit(coxph(Surv(time, status) ~ age + sex, .))))
    
    glances
    
    qplot(glances$median, binwidth = 15)
    quantile(glances$median, c(.025, .975))
}

</pre>

<hr /><div style="text-align: center;">[Package <em>broom</em> version 0.4.5 <a href="00Index.html">Index</a>]</div>
</body></html>
