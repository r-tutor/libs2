<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Case bootstrapping and associated S3 methods.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for bootstrap {FSA}"><tr><td>bootstrap {FSA}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Case bootstrapping and associated S3 methods.</h2>

<h3>Description</h3>

<p>The <code>bootCase</code> function was added to <span class="pkg">FSA</span> to maintain backward compatability (because <code>bootCase</code> was removed from <span class="pkg">car</span>), mostly for users of the Introductory Fisheries Analyses with R book. <code>bootCase</code> is largerly a wrapper to <code><a href="../../car/html/Boot.html">Boot</a></code> from <span class="pkg">car</span> with <code>method="case"</code>. It is suggested that <code><a href="../../car/html/Boot.html">Boot</a></code> from <span class="pkg">car</span> be used instead. S3 methods are also provided to construct non-parametric bootstrap confidence intervals, predictions with non-parametric confidence intervals, hypothesis tests, and plots of the parameter estimates for <code>bootCase</code> objects.
</p>


<h3>Usage</h3>

<pre>
bootCase(object, f. = stats::coef, B = R, R = 999)

## S3 method for class 'bootCase'
confint(object, parm = NULL, level = conf.level,
  conf.level = 0.95, plot = FALSE, err.col = "black", err.lwd = 2,
  rows = NULL, cols = NULL, ...)

## S3 method for class 'bootCase'
predict(object, FUN, conf.level = 0.95,
  digits = NULL, ...)

## S3 method for class 'bootCase'
htest(object, parm = NULL, bo = 0,
  alt = c("two.sided", "less", "greater"), plot = FALSE, ...)

## S3 method for class 'bootCase'
hist(x, same.ylim = TRUE, ymax = NULL,
  rows = round(sqrt(ncol(x))), cols = ceiling(sqrt(ncol(x))), ...)

## S3 method for class 'bootCase'
plot(x, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object, x</code></td>
<td>
<p>A regression object of type <code>lm</code>, <code>glm</code> or class <code>nls</code> for <code>bootCase</code> or a <code>bootCase</code> object for the S3 methods.</p>
</td></tr>
<tr valign="top"><td><code>f.</code></td>
<td>
<p>A function that will be applied to the updated regression object to compute the statistics of interest. The default is <code>coef</code>, to return to regression coefficient estimates.</p>
</td></tr>
<tr valign="top"><td><code>B, R</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td></tr>
<tr valign="top"><td><code>parm</code></td>
<td>
<p>A number or string that indicates which column of <code>object</code> contains the parameter estimates to use for the confidence interval or hypothesis test.</p>
</td></tr>
<tr valign="top"><td><code>level</code></td>
<td>
<p>Same as <code>conf.level</code>.</p>
</td></tr>
<tr valign="top"><td><code>conf.level</code></td>
<td>
<p>A level of confidence as a proportion.</p>
</td></tr>
<tr valign="top"><td><code>plot</code></td>
<td>
<p>A logical that indicates whether a plot should be constructed. If <code>confint</code> then a histogram of the <code>parm</code> parameters from the bootstrap samples with error bars that illustrate the bootstrapped confidence intervals will be constructed. If codehtest then a histogram of the <code>parm</code> parameters with a vertical line illustrating the <code>bo</code> value will be constructed.</p>
</td></tr>
<tr valign="top"><td><code>err.col</code></td>
<td>
<p>A single numeric or character that identifies the color for the error bars on the plot.</p>
</td></tr>
<tr valign="top"><td><code>err.lwd</code></td>
<td>
<p>A single numeric that identifies the line width for the error bars on the plot.</p>
</td></tr>
<tr valign="top"><td><code>rows</code></td>
<td>
<p>A single numeric that contains the number of rows to use on the graphic.</p>
</td></tr>
<tr valign="top"><td><code>cols</code></td>
<td>
<p>A single numeric that contains the number of columns to use on the graphic.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional items to send to functions. See details.</p>
</td></tr>
<tr valign="top"><td><code>FUN</code></td>
<td>
<p>The function to be applied for the prediction. See the examples.</p>
</td></tr>
<tr valign="top"><td><code>digits</code></td>
<td>
<p>A single numeric that indicates the number of digits for the result.</p>
</td></tr>
<tr valign="top"><td><code>bo</code></td>
<td>
<p>The null hypothesized parameter value.</p>
</td></tr>
<tr valign="top"><td><code>alt</code></td>
<td>
<p>A string that indicates the &ldquo;direction&rdquo; of the alternative hypothesis. See details.</p>
</td></tr>
<tr valign="top"><td><code>same.ylim</code></td>
<td>
<p>A logical that indicates whether the same limits for the y-axis should be used on each histogram. Defaults to <code>TRUE</code>. Ignored if <code>ylmts</code> is non-null.</p>
</td></tr>
<tr valign="top"><td><code>ymax</code></td>
<td>
<p>A single value that sets the maximum y-axis limit for each histogram or a vector of length equal to the number of groups that sets the maximum y-axis limit for each histogram separately.</p>
</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>A named color for the histogram bars.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>confint</code> finds the two quantiles that have the (1-<code>conf.level</code>)/2 proportion of bootstrapped parameter estimates below and above. This is an approximate 100<code>conf.level</code>% confidence interval.
</p>
<p><code>predict</code> applies a user-supplied function to each row of <code>object</code> and then finds the median and the two quantiles that have the proportion (1-<code>conf.level</code>)/2 of the bootstrapped predictions below and above. The median is returned as the predicted value and the quantiles are returned as an approximate 100<code>conf.level</code>% confidence interval for that prediction. Values for the independent variable in <code>FUN</code> must be a named argument sent in the ... argument (see examples). Note that if other arguments are needed in <code>FUN</code> besides values for the independent variable, then these are included in the ... argument AFTER the values for the independent variable.
</p>
<p>In <code>htest</code> the &ldquo;direction&rdquo; of the alternative hypothesis is identified by a string in the <code>alt=</code> argument. The strings may be <code>"less"</code> for a &ldquo;less than&rdquo; alternative, <code>"greater"</code> for a &ldquo;greater than&rdquo; alternative, or <code>"two.sided"</code> for a &ldquo;not equals&rdquo; alternative (the DEFAULT). In the one-tailed alternatives the p-value is the proportion of bootstrapped parameter estimates in <code>object$coefboot</code> that are extreme of the null hypothesized parameter value in <code>bo</code>. In the two-tailed alternative the p-value is twice the smallest of the proportion of bootstrapped parameter estimates above or below the null hypothesized parameter value in <code>bo</code>.
</p>


<h3>Value</h3>

<p>If <code>object</code> is a matrix, then <code>confint</code> returns a matrix with as many rows as columns (i.e., parameter estimates) in <code>object</code> and two columns of the quantiles that correspond to the approximate confidence interval. If <code>object</code> is a vector, then <code>confint</code> returns a vector with the two quantiles that correspond to the approximate confidence interval.
</p>
<p><code>htest</code> returns a two-column matrix with the first column containing the hypothesized value sent to this function and the second column containing the corresponding p-value.
</p>
<p><code>hist</code> constructs histograms of the bootstrapped parameter estimates.
</p>
<p><code>plot</code> constructs scatterplots of all pairs of bootstrapped parameter estimates.
</p>
<p><code>predict</code> returns a matrix with one row and three columns, with the first column holding the predicted value (i.e., the median prediction) and the last two columns holding the approximate confidence interval.
</p>


<h3>Author(s)</h3>

<p>Derek H. Ogle, <a href="mailto:derek@derekogle.com">derek@derekogle.com</a>
</p>


<h3>References</h3>

<p>S. Weisberg (2005). <em>Applied Linear Regression</em>, third edition. New York: Wiley, Chapters 4 and 11.
</p>


<h3>See Also</h3>

<p><code><a href="../../car/html/Boot.html">Boot</a></code> in <span class="pkg">car</span>.
</p>


<h3>Examples</h3>

<pre>
fnx &lt;- function(days,B1,B2,B3) {
  if (length(B1) &gt; 1) {
    B2 &lt;- B1[2]
    B3 &lt;- B1[3]
    B1 &lt;- B1[1]
  }
  B1/(1+exp(B2+B3*days))
}
nl1 &lt;- nls(cells~fnx(days,B1,B2,B3),data=Ecoli,
           start=list(B1=6,B2=7.2,B3=-1.45))
nl1.bootc &lt;- bootCase(nl1,coef,B=99)  # B=99 too few to be useful
confint(nl1.bootc,"B1")
confint(nl1.bootc,c(2,3))
confint(nl1.bootc,conf.level=0.90)
confint(nl1.bootc,plot=TRUE)
predict(nl1.bootc,fnx,days=1:3)
predict(nl1.bootc,fnx,days=3)
htest(nl1.bootc,1,bo=6,alt="less")
hist(nl1.bootc)
plot(nl1.bootc)
cor(nl1.bootc)

</pre>

<hr /><div style="text-align: center;">[Package <em>FSA</em> version 0.8.24 <a href="00Index.html">Index</a>]</div>
</body></html>
