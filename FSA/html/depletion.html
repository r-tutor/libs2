<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Computes the Leslie or DeLury population estimate from catch...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for depletion {FSA}"><tr><td>depletion {FSA}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Computes the Leslie or DeLury population estimate from catch and effort data.</h2>

<h3>Description</h3>

<p>Computes the Leslie or DeLury estimates of population size and catchability coefficient from paired catch and effort data.  The Ricker modification may also be used.
</p>


<h3>Usage</h3>

<pre>
depletion(catch, effort, method = c("Leslie", "DeLury", "Delury"),
  Ricker.mod = FALSE)

## S3 method for class 'depletion'
summary(object, parm = c("all", "both", "No", "q",
  "lm"), verbose = FALSE, ...)

## S3 method for class 'depletion'
coef(object, parm = c("all", "both", "No", "q",
  "lm"), ...)

## S3 method for class 'depletion'
confint(object, parm = c("all", "both", "No", "q",
  "lm"), level = conf.level, conf.level = 0.95, ...)

## S3 method for class 'depletion'
anova(object, ...)

## S3 method for class 'depletion'
rSquared(object, digits = getOption("digits"),
  percent = FALSE, ...)

## S3 method for class 'depletion'
plot(x, xlab = NULL, ylab = NULL, pch = 19,
  col.pt = "black", col.mdl = "gray70", lwd = 1, lty = 1,
  pos.est = "topright", cex.est = 0.95, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>catch</code></td>
<td>
<p>A numeric vector of catches of fish at each time.</p>
</td></tr>
<tr valign="top"><td><code>effort</code></td>
<td>
<p>A numeric vector of efforts expended at each time.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>A single string that indicates which depletion method to use</p>
</td></tr>
<tr valign="top"><td><code>Ricker.mod</code></td>
<td>
<p>A single logical that indicates whether to use the modification proposed by Ricker (=TRUE) or not (=FALSE, default).</p>
</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>
<p>An object saved from the <code>removal</code> call (i.e., of class <code>depletion</code>).</p>
</td></tr>
<tr valign="top"><td><code>parm</code></td>
<td>
<p>A specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names.  If missing, all parameters are considered.</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>A logical that indicates whether a reminder of the method used should be printed with the summary results.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional arguments for methods.</p>
</td></tr>
<tr valign="top"><td><code>level</code></td>
<td>
<p>Same as <code>conf.level</code> but used for compatibility with generic <code>confint</code> function.</p>
</td></tr>
<tr valign="top"><td><code>conf.level</code></td>
<td>
<p>A single number that represents the level of confidence to use for constructing confidence intervals.</p>
</td></tr>
<tr valign="top"><td><code>digits</code></td>
<td>
<p>The number of digits to round the <code>rSquared</code> result to.</p>
</td></tr>
<tr valign="top"><td><code>percent</code></td>
<td>
<p>A logical that indicates if the <code>rSquared</code> result should be returned as a percentage (<code>=TRUE</code>) or as a proportion (<code>=FALSE</code>; default).</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>An object saved from the <code>depletion</code> call (i.e., of class <code>depletion</code>).</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>A label for the x-axis.</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>A label for the y-axis.</p>
</td></tr>
<tr valign="top"><td><code>pch</code></td>
<td>
<p>A numeric that indicates the type of plotting character.</p>
</td></tr>
<tr valign="top"><td><code>col.pt</code></td>
<td>
<p>A string that indicates the color of the plotted points.</p>
</td></tr>
<tr valign="top"><td><code>col.mdl</code></td>
<td>
<p>A string that indicates the color of the fitted line.</p>
</td></tr>
<tr valign="top"><td><code>lwd</code></td>
<td>
<p>A numeric that indicates the line width of the fitted line.</p>
</td></tr>
<tr valign="top"><td><code>lty</code></td>
<td>
<p>A numeric that indicates the type of line used for the fitted line.</p>
</td></tr>
<tr valign="top"><td><code>pos.est</code></td>
<td>
<p>A single string to identify where to place the estimated population estimate and catchability on the plot.  Can be set to one of <code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> or <code>"center"</code> for positioning the estimated mortality rates on the plot.  Typically <code>"bottomleft"</code> (DEFAULT) and <code>"topright"</code> will be &ldquo;out-of-the-way&rdquo; placements.  Set <code>pos.est</code> to <code>NULL</code> to remove the estimated population size and catchability coefficient from the plot.</p>
</td></tr>
<tr valign="top"><td><code>cex.est</code></td>
<td>
<p>A single numeric that identifies the character expansion value for the estimated population estimate and catchability placed on the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the Leslie method, a linear regression model of catch-per-unit-effort on cumulative catch prior to the sample is fit.  The catchability coefficient (q) is estimated from the negative of the slope and the initial population size (No) is estimated by dividing the intercept by the catchability coefficient.  If <code>Ricker.mod=TRUE</code> then the cumulative catch is modified to be the cumulative catch prior to the sample plus half of the catch of the current sample.
</p>
<p>For the DeLury method, a linear regression model of log (catch-per-unit-effort) on cumulative effort is fit.  The catchability coefficient (q) is estimated from the negative of the slope and the initial population size (No) is estimated by dividing the intercept as an exponent of e by the catchability coefficient.  If <code>Ricker.mod=TRUE</code> then the cumulative effort is modified to be the cumulative effort prior to the sample plus half of the effort of the current sample.
</p>
<p>Standard errors for the catchability and population size estimates are computed from formulas on page 298 (for Leslie) and 303 (for DeLury) from Seber (2002).  Confidence intervals are computed using standard large-sample normal distribution theory with the regression error df.
</p>


<h3>Value</h3>

<p>A list with the following items:
</p>

<ul>
<li><p> method A string that indicates whether the <code>"Leslie"</code> or <code>"DeLury"</code> model was used.
</p>
</li>
<li><p> catch The original vector of catches.
</p>
</li>
<li><p> effort The original vector of efforts.
</p>
</li>
<li><p> cpe A computed vector of catch-per-unit-effort for each time.
</p>
</li>
<li><p> KorE A computed vector of cumulative catch (K; Leslie method) or effort (E; DeLury method).
</p>
</li>
<li><p> lm The <code>lm</code> object from the fit of CPE on K (Leslie method) or log(CPE) on E (DeLury method).
</p>
</li>
<li><p> est A 2x2 matrix that contains the estimates and standard errors for No and q.
</p>
</li></ul>



<h3>testing</h3>

<p>The Leslie method without the Ricker modification and the DeLury method with the Ricker modification matches the results from <code><a href="../../fishmethods/html/deplet.html">deplet</a></code> in <span class="pkg">fishmethods</span> for the <code><a href="../../fishmethods/html/darter.html">darter</a></code> (from <span class="pkg">fishmethods</span>), <code><a href="../../FSAdata/html/LobsterPEI.html">LobsterPEI</a></code> and <code><a href="../../FSAdata/html/BlueCrab.html">BlueCrab</a></code> from <span class="pkg">FSAdata</span>, and <code><a href="SMBassLS.html">SMBassLS</a></code> for N0 to whole numbers, the SE for No to one decimal, q to seven decimals, and the SE of q to at least five decimals.
</p>
<p>The Leslie method matches the results of Seber (2002) for N0, q, and the CI for Q but not the CI for N (which was so far off that it might be that Seber's result is incorrect) for the lobster data and the q and CI for q but the NO or its CI (likely due to lots of rounding in Seber 2002) for the Blue Crab data.
</p>
<p>The Leslie and DeLury methods match the results of Ricker (1975) for No and Q but not for the CI of No (Ricker used a very different method to compute CIs).
</p>


<h3>IFAR Chapter</h3>

<p>10-Abundance from Depletion Data.
</p>


<h3>Author(s)</h3>

<p>Derek H. Ogle, <a href="mailto:derek@derekogle.com">derek@derekogle.com</a>
</p>


<h3>References</h3>

<p>Ogle, D.H.  2016.  <a href="http://derekogle.com/IFAR">Introductory Fisheries Analyses with R</a>.  Chapman &amp; Hall/CRC, Boca Raton, FL.
</p>
<p>Ricker, W.E. 1975. Computation and interpretation of biological statistics of fish populations. Technical Report Bulletin 191, Bulletin of the Fisheries Research Board of Canada.  [Was (is?) from http://www.dfo-mpo.gc.ca/Library/1485.pdf.]
</p>
<p>Seber, G.A.F. 2002. The Estimation of Animal Abundance. Edward Arnold, Second edition (reprinted).
</p>


<h3>See Also</h3>

<p>See <code><a href="removal.html">removal</a></code> for related functionality and <code><a href="../../fishmethods/html/deplet.html">deplet</a></code> in <span class="pkg">fishmethods</span> for similar functionality.
</p>


<h3>Examples</h3>

<pre>
## Leslie model examples
# no Ricker modification
l1 &lt;- depletion(SMBassLS$catch,SMBassLS$effort,method="Leslie")
summary(l1)
summary(l1,verbose=TRUE)
summary(l1,parm="No")
rSquared(l1)
rSquared(l1,digits=1,percent=TRUE)
cbind(Est=coef(l1),confint(l1))
cbind(Est=coef(l1,parm="No"),confint(l1,parm="No"))
cbind(Est=coef(l1,parm="q"),confint(l1,parm="q"))
summary(l1,parm="lm")
plot(l1)

# with Ricker modification
l2 &lt;- depletion(SMBassLS$catch,SMBassLS$effort,method="Leslie",Ricker.mod=TRUE)
summary(l2)
cbind(Est=coef(l2),confint(l1))
plot(l2)

## DeLury model examples
# no Ricker modification
d1 &lt;- depletion(SMBassLS$catch,SMBassLS$effort,method="DeLury")
summary(d1)
summary(d1,parm="q")
summary(d1,verbose=TRUE)
rSquared(d1)
cbind(Est=coef(d1),confint(d1))
summary(d1,parm="lm")
plot(d1)

# with Ricker modification
d2 &lt;- depletion(SMBassLS$catch,SMBassLS$effort,method="DeLury",Ricker.mod=TRUE)
summary(d2)
cbind(Est=coef(d2),confint(d2))
cbind(Est=coef(d2,parm="q"),confint(d2,parm="q"))
plot(d2)

</pre>

<hr /><div style="text-align: center;">[Package <em>FSA</em> version 0.8.23 <a href="00Index.html">Index</a>]</div>
</body></html>
