<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Likelihood ratio and extra sum-of-squares tests.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for extraTests {FSA}"><tr><td>extraTests {FSA}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Likelihood ratio and extra sum-of-squares tests.</h2>

<h3>Description</h3>

<p>Likelihood ratio and extra sum-of-squares tests with multiple <code>lm</code> or <code>nls</code> models nested within one common model. This function is most useful when the nested functions are all at the same level; otherwise use <code>anova()</code> or <code>lrtest()</code> which are more flexible.
</p>


<h3>Usage</h3>

<pre>
lrt(sim, ..., com, sim.names = sim.name, sim.name = NULL,
  com.name = NULL)

extraSS(sim, ..., com, sim.names = sim.name, sim.name = NULL,
  com.name = NULL)

## S3 method for class 'extraTest'
print(x, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>sim</code></td>
<td>
<p>The results of one <code>lm</code> or <code>nls</code> model, for example, that is a nested subset of the model in <code>com=</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>More model results that are nested subsets of the model in <code>com=</code>.</p>
</td></tr>
<tr valign="top"><td><code>com</code></td>
<td>
<p>The results of one <code>lm</code> or <code>nls</code> model, for example, that the models in <code>sim=</code> and <code>...</code> are a subset of.</p>
</td></tr>
<tr valign="top"><td><code>sim.name, sim.names</code></td>
<td>
<p>A string vector of &ldquo;names&rdquo; for simple model in <code>sim=</code> and <code>...</code>. <code>sim.names</code> is preferred but <code>sim.name</code> is allowed to allow for a common typing mistake.</p>
</td></tr>
<tr valign="top"><td><code>com.name</code></td>
<td>
<p>A single &ldquo;name&rdquo; string for the complex model in <code>com=</code>.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>An object from <code>lrt()</code> or <code>extraSS()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="../../stats/html/anova.html">anova</a></code> and <code><a href="../../lmtest/html/lrtest.html">lrtest</a></code> (from <span class="pkg">lmtest</span>) provide simple methods for conducting extra sum-of-squares or likelihood ratio tests when one model is nested within another model or when there are several layers of simple models all sequentially nested within each other. However, to compare several models that are nested at the same level with one common more complex model, then <code>anova()</code> and <code>lrtest()</code> must be repeated for each comparison. This repetition can be eliminated with <code>lapply()</code> but then the output is voluminous. This function is designed to remove the repetitiveness and to provide output that is compact and easy to read.
</p>


<h3>Value</h3>

<p>The main function returns a matrix with as many rows as model comparisons and columns of the following types:
</p>

<ul>
<li> <p><code>DfO</code> The error degrees-of-freedom from the subset (more simple) model.
</p>
</li>
<li> <p><code>RSSO</code>, <code>logLikO</code> The residual sum-of-squares (from <code>extraSS</code>) or log-likelihood (from <code>lrt</code>) from the subset (more simple) model.
</p>
</li>
<li> <p><code>DfA</code> The error degrees-of-freedom from the <code>com=</code> model.
</p>
</li>
<li> <p><code>RSSA</code>, <code>logLikA</code> The residual sum-of-squares (from <code>extraSS</code>) or log-likelihood (from <code>lrt</code>) from the <code>com=</code> model.
</p>
</li>
<li> <p><code>Df</code> The difference in error degrees-of-freedom between the two models.
</p>
</li>
<li> <p><code>SS</code>, <code>logLik</code> The difference in residual sum-of-squares (from <code>extraSS</code>) or log-likelihood (from <code>lrt</code>) between the two models.
</p>
</li>
<li> <p><code>F</code>, <code>Chisq</code> The corresponding F- (from <code>extraSS</code>) or Chi-square (from <code>lrt</code>) test statistic.
</p>
</li>
<li> <p><code>Pr(&gt;F)</code>, <code>Pr(&gt;Chisq)</code> The corresponding p-value.
</p>
</li></ul>



<h3>Note</h3>

<p>This function is experimental at this point. It seems to work fine for <code>lm</code> and <code>nls</code> models. An error will be thrown by <code>extraSS</code> for other model classes, but <code>lrt</code> will not (but it has not been thoroughly tests for other models).
</p>


<h3>Author(s)</h3>

<p>Derek H. Ogle, <a href="mailto:derek@derekogle.com">derek@derekogle.com</a>
</p>


<h3>Examples</h3>

<pre>
## Example data
df &lt;- data.frame(x=c(1,2,3,4,5,6,7,8,9,10),
                 y=c(4,6,5,7,9,8,7,12,16,22),
                 z=as.factor(rep(c("A","B"),each=5)),
                 w=as.factor(rep(c("A","B"),times=5)))
df$x2 &lt;- df$x^2

## Linear (lm()) models
#  ... regression
fit.0 &lt;- lm(y~1,data=df)
fit.1 &lt;- lm(y~x,data=df)
fit.2 &lt;- lm(y~x2+x,data=df)
extraSS(fit.0,fit.1,com=fit.2)
lrt(fit.0,fit.1,com=fit.2)

# ... show labels for models
extraSS(fit.0,fit.1,com=fit.2,
    sim.names=c("Null Model","Linear"),com.name="Quadratic")
lrt(fit.0,fit.1,com=fit.2,
    sim.names=c("Null Model","Linear"),com.name="Quadratic")

#  ... dummy variable regression
fit.2b &lt;- lm(y~x*z,data=df)
extraSS(fit.0,fit.1,com=fit.2b)
lrt(fit.0,fit.1,com=fit.2b)

#  ... ANOVAs
fit.1 &lt;- lm(y~w,data=df)
fit.2 &lt;- lm(y~w*z,data=df)
extraSS(fit.0,fit.1,com=fit.2)
lrt(fit.0,fit.1,com=fit.2)


## Non-linear (nls()) models
fit.0 = nls(y~c,data=df,start=list(c=10))
fit.1 = nls(y~a*x+c,data=df,start=list(a=1,c=1))
fit.2 = nls(y~b*x2+a*x+c,data=df,start=list(a=-1,b=0.3,c=10))
extraSS(fit.0,fit.1,com=fit.2)
lrt(fit.0,fit.1,com=fit.2)

## General least-squares (gls()) models
## Not run: 
  require(nlme)
  fit.0 &lt;- gls(y~1,data=df,method="ML")
  fit.1 &lt;- gls(y~x,data=df,method="ML")
  fit.2 &lt;- gls(y~x2+x,data=df,method="ML")
  lrt(fit.0,fit.1, com=fit.2)
  ## will return an error ... does not work with gls() models
  # extraSS(fit.0,fit.1, com=fit.2)

## End(Not run)

</pre>

<hr /><div style="text-align: center;">[Package <em>FSA</em> version 0.8.25 <a href="00Index.html">Index</a>]</div>
</body></html>
