<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Mean Values-at-age from an age-length key</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for alkMeanVar {FSA}"><tr><td>alkMeanVar {FSA}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Mean Values-at-age from an age-length key</h2>

<h3>Description</h3>

<p>Computes the mean value-at-age in a larger sample based on an age-length-key created from a subsample of ages through a two-stage random sampling design. The mean values could be mean length-, weight-, or fecundity-at-age, for example. The methods of Bettoli and Miranda (2001) or Quinn and Deriso (1999) are used. A standard deviation is computed for the Bettoli and Miranda (2001) method and standard error for the Quinn and Deriso (1999) method. See the testing section notes.
</p>


<h3>Usage</h3>

<pre>
alkMeanVar(key, formula, data, len.n, method = c("BettoliMiranda",
  "QuinnDeriso"))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>key</code></td>
<td>
<p>A numeric matrix that contains the age-length key. See details.</p>
</td></tr>
<tr valign="top"><td><code>formula</code></td>
<td>
<p>A formula of the form <code>var~lencat+age</code> where <code>var</code> generically represents the variable to be summarized (e.g., length, weight, fecundity), <code>lencat</code> generically represents the variable that contains the length intervals, and <code>age</code> generically represents the variable that contains the assigned ages.</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>A data.frame that minimally contains the length intervals, assessed ages, and the variable to be summarized (i.e., this should be the aged sample) as given in <code>formula</code>.</p>
</td></tr>
<tr valign="top"><td><code>len.n</code></td>
<td>
<p>A vector of sample sizes for each length interval in the <em>complete sample</em> (i.e., all fish regardless of whether they were aged or not).</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>A string that indicates which method of calculation should be used. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The age-length key <code>key</code> must have length intervals as rows and ages as columns. The row names of <code>key</code> (i.e., <code>rownames(key)</code>) must contain the minimum values of each length interval (e.g., if an interval is 100-109, then the corresponding row name must be 100). The column names of <code>key</code> (i.e., <code>colnames(key)</code>) must contain the age values (e.g., the columns can NOT be named with &ldquo;age.1&rdquo;, for example).
</p>
<p>The length intervals in the rows of <code>key</code> must contain all of the length intervals present in the larger sample. Thus, the length of <code>len.n</code> must, at least, equal the number of rows in <code>key</code>. If this constraint is not met, then the function will stop with an error message.
</p>
<p>Note that the function will stop with an error if the formula in <code>formula</code> does not meet the specific criteria outlined in the parameter list above.
</p>


<h3>Value</h3>

<p>A data.frame with as many rows as ages (columns) present in <code>key</code> and the following three variables:
</p>

<ul>
<li><p> age The ages.
</p>
</li>
<li><p> mean The mean value at each age.
</p>
</li>
<li><p> sd,se The SD if <code>method="BettoliMiranda"</code> or SE of the mean if <code>method="QuinnDeriso"</code> for the value at each age.
</p>
</li></ul>



<h3>Testing</h3>

<p>The results of these functions have not yet been rigorously tested. The Bettoli and Miranda (2001) results appear, at least, approximately correct when compared to the results from <code><a href="alkIndivAge.html">alkIndivAge</a></code>. The Quinn and Deriso (1999) results appear at least approximately correct for the mean values, but do not appear to be correct for the SE values. Thus, a note is returned with the Quinn and Deriso (1999) results that the SE should not be trusted.
</p>


<h3>IFAR Chapter</h3>

<p>5-Age-Length Key.
</p>


<h3>Author(s)</h3>

<p>Derek H. Ogle, <a href="mailto:derek@derekogle.com">derek@derekogle.com</a>
</p>


<h3>References</h3>

<p>Ogle, D.H. 2016. <a href="http://derekogle.com/IFAR">Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.
</p>
<p>Bettoli, P. W. and Miranda, L. E. 2001. A cautionary note about estimating mean length at age with subsampled data. North American Journal of Fisheries Management, 21:425-428.
</p>
<p>Quinn, T. J. and R. B. Deriso. 1999. Quantitative Fish Dynamics. Oxford University Press, New York, New York. 542 pages
</p>


<h3>See Also</h3>

<p>See <code><a href="alkIndivAge.html">alkIndivAge</a></code> and related functions for a completely different methodology. See <code><a href="alkAgeDist.html">alkAgeDist</a></code> for a related method of determining the proportion of fish at each age. See the <span class="pkg">ALKr</span> package.
</p>


<h3>Examples</h3>

<pre>
## Example -- Even breaks for length categories
WR1 &lt;- WR79
# add length intervals (width=5)
WR1$LCat &lt;- lencat(WR1$len,w=5)
# get number of fish in each length interval in the entire sample
len.n &lt;- xtabs(~LCat,data=WR1)
# isolate aged sample
WR1.age &lt;- subset(WR1, !is.na(age))
# create age-length key
raw &lt;- xtabs(~LCat+age,data=WR1.age)
( WR1.key &lt;- prop.table(raw, margin=1) )

## use age-length key to estimate mean length-at-age of all fish
# Bettoli-Miranda method
alkMeanVar(WR1.key,len~LCat+age,WR1.age,len.n)

# Quinn-Deriso method
alkMeanVar(WR1.key,len~LCat+age,WR1.age,len.n,method="QuinnDeriso")

</pre>

<hr /><div style="text-align: center;">[Package <em>FSA</em> version 0.8.25 <a href="00Index.html">Index</a>]</div>
</body></html>
