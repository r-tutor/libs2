<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Computes Chapman-Robson estimates of S and Z.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for chapmanRobson {FSA}"><tr><td>chapmanRobson {FSA}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Computes Chapman-Robson estimates of S and Z.</h2>

<h3>Description</h3>

<p>Computes the Chapman-Robson estimates of annual survival rate (S) and instantaneous mortality rate (Z) from catch-at-age data on the descending limb of a catch-curve. Method functions extract estimates with associated standard errors and confidence intervals. A plot method highlights the descending-limb, shows the linear model on the descending limb, and, optionally, prints the estimated Z and A.
</p>


<h3>Usage</h3>

<pre>
chapmanRobson(x, ...)

## Default S3 method:
chapmanRobson(x, catch, ages2use = age,
  zmethod = c("Smithetal", "Hoenigetal", "original"), ...)

## S3 method for class 'formula'
chapmanRobson(x, data, ages2use = age,
  zmethod = c("Smithetal", "Hoenigetal", "original"), ...)

## S3 method for class 'chapmanRobson'
summary(object, parm = c("all", "both", "Z",
  "S"), verbose = FALSE, ...)

## S3 method for class 'chapmanRobson'
coef(object, parm = c("all", "both", "Z", "S"),
  ...)

## S3 method for class 'chapmanRobson'
confint(object, parm = c("all", "both", "S",
  "Z"), level = conf.level, conf.level = 0.95, ...)

## S3 method for class 'chapmanRobson'
plot(x, pos.est = "topright", cex.est = 0.95,
  ylab = "Catch", xlab = "Age", col.pt = "gray30",
  axis.age = c("both", "age", "recoded age"), ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>A numerical vector of the assigned ages in the catch curve or a formula of the form <code>catch~age</code> when used in <code>chapmanRobson</code>. An object saved from <code>chapmanRobson</code> (i.e., of class <code>chapmanRobson</code>) when used in the methods.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional arguments for methods.</p>
</td></tr>
<tr valign="top"><td><code>catch</code></td>
<td>
<p>A numerical vector of the catches or CPUEs for the ages in the catch curve. Not used if <code>x</code> is a formula.</p>
</td></tr>
<tr valign="top"><td><code>ages2use</code></td>
<td>
<p>A numerical vector of the ages that define the descending limb of the catch curve.</p>
</td></tr>
<tr valign="top"><td><code>zmethod</code></td>
<td>
<p>A string that indicates the method to use for estimating Z. See details.</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>A data frame from which the variables in the <code>x</code> formula can be found. Not used if <code>x</code> is not a formula.</p>
</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>
<p>An object saved from the <code>chapmanRobson</code> call (i.e., of class <code>chapmanRobson</code>).</p>
</td></tr>
<tr valign="top"><td><code>parm</code></td>
<td>
<p>A numeric or string (of parameter names) vector that specifies which parameters are to be given confidence intervals  If missing, all parameters are considered.</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>A logical that indicates whether the method should return just the estimate (<code>FALSE</code>; default) or a more verbose statement.</p>
</td></tr>
<tr valign="top"><td><code>level</code></td>
<td>
<p>Same as <code>conf.level</code>. Used for compatibility with the generic <code>confint</code> function.</p>
</td></tr>
<tr valign="top"><td><code>conf.level</code></td>
<td>
<p>A number representing the level of confidence to use for constructing confidence intervals.</p>
</td></tr>
<tr valign="top"><td><code>pos.est</code></td>
<td>
<p>A string to identify where to place the estimated mortality rates on the plot. Can be set to one of <code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> or <code>"center"</code> for positioning the estimated mortality rates on the plot. Typically <code>"bottomleft"</code> (DEFAULT) and <code>"topright"</code> will be &ldquo;out-of-the-way&rdquo; placements. Set <code>pos.est</code> to <code>NULL</code> to remove the estimated mortality rates from the plot.</p>
</td></tr>
<tr valign="top"><td><code>cex.est</code></td>
<td>
<p>A single numeric character expansion value for the estimated mortality rates on the plot.</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>A label for the y-axis (<code>"Catch"</code> is the default).</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>A label for the x-axis (<code>"Age"</code> is the default).</p>
</td></tr>
<tr valign="top"><td><code>col.pt</code></td>
<td>
<p>A string that indicates the color of the plotted points.</p>
</td></tr>
<tr valign="top"><td><code>axis.age</code></td>
<td>
<p>A string that indicates the type of x-axis to display. The <code>age</code> will display only the original ages, <code>recoded age</code> will display only the recoded ages, and <code>both</code> (DEFAULT) displays the original ages on the main axis and the recoded ages on the secondary axis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default is to use all ages in the age vector. This is only appropriate if the age and catch vectors contain only the ages and catches on the descending limb of the catch curve. Use <code>ages2use</code> to isolate only the catch and ages on the descending limb.
</p>
<p>The Chapman-Robson method provides an estimate of the annual survival rate, with the annual mortality rate (A) determined by 1-S. The instantaneous mortality rate is often computed as -log(S). However, Hoenig et al. (1983) showed that this produced a biased (over)estimate of Z and provided a correction. The correction is applied by setting <code>zmethod="Hoenigetal"</code>. Smith et al. (2012) showed that the Hoenig et al. method should be corrected for a variance inflation factor. This correction is applied by setting <code>zmethod="Smithetal"</code> (which is the default behavior). Choose <code>zmethod="original"</code> to use the original estimates for Z and it's SE as provided by Chapman and Robson.
</p>


<h3>Value</h3>

<p>A list with the following items:
</p>

<ul>
<li><p> age the original vector of assigned ages.
</p>
</li>
<li><p> catch the original vector of observed catches or CPUEs.
</p>
</li>
<li><p> age.e a vector of assigned ages used to estimate mortalities.
</p>
</li>
<li><p> catch.e a vector of catches or CPUEs used to estimate mortalities.
</p>
</li>
<li><p> age.r a vector of recoded ages used to estimate mortalities. See references.
</p>
</li>
<li><p> n a numeric holding the intermediate calculation of n. See references.
</p>
</li>
<li><p> T a numeric holding the intermediate calculation of T. See references.
</p>
</li>
<li><p> est A 2x2 matrix that contains the estimates and standard errors for S and Z.
</p>
</li></ul>



<h3>Testing</h3>

<p>Tested the results of chapmanRobson against the results in Miranda and Bettoli (2007). The point estimates of S matched perfectly but the SE of S did not because Miranda and Bettoli used a rounded estimate of S in the calculation of the SE of S but chapmanRobson does not.
</p>
<p>Tested the results against the results from <code>agesurv</code> in <span class="pkg">fishmethods</span> using the <code>rockbass</code> data.frame in <span class="pkg">fishmethods</span>. Results for Z and the SE of Z matched perfectly for non-bias-corrected results. The estimate of Z, but not the SE of Z, matched for the bias-corrected (following Smith et al. (2012)) results. <span class="pkg">FSA</span> uses equation 2 from Smith et al. (2012) whereas <span class="pkg">fishmethods</span> appears to use equation 5 from the same source to estimate the SE of Z.
</p>


<h3>IFAR Chapter</h3>

<p>11-Mortality.
</p>


<h3>Author(s)</h3>

<p>Derek H. Ogle, <a href="mailto:derek@derekogle.com">derek@derekogle.com</a>
</p>


<h3>References</h3>

<p>Ogle, D.H. 2016. <a href="http://derekogle.com/IFAR">Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.
</p>
<p>Chapman, D.G. and D.S. Robson. 1960. The analysis of a catch curve. Biometrics. 16:354-368.
</p>
<p>Hoenig, J.M. and W.D. Lawing, and N.A. Hoenig. 1983. Using mean age, mean length and median length data to estimate the total mortality rate. International Council for the Exploration of the Sea, CM 1983/D:23, Copenhagen.
</p>
<p>Ricker, W.E. 1975. Computation and interpretation of biological statistics of fish populations. Technical Report Bulletin 191, Bulletin of the Fisheries Research Board of Canada. [Was (is?) from http://www.dfo-mpo.gc.ca/Library/1485.pdf.]
</p>
<p>Robson, D.S. and D.G. Chapman. 1961. Catch curves and mortality rates. Transactions of the American Fisheries Society. 90:181-189.
</p>
<p>Smith, M.W., A.Y. Then, C. Wor, G. Ralph, K.H. Pollock, and J.M. Hoenig. 2012. Recommendations for catch-curve analysis. North American Journal of Fisheries Management. 32:956-967.
</p>


<h3>See Also</h3>

<p>See <code><a href="../../fishmethods/html/agesurv.html">agesurv</a></code> in <span class="pkg">fishmethods</span> for similar functionality. See <code><a href="catchCurve.html">catchCurve</a></code> and <code><a href="../../fishmethods/html/agesurvcl.html">agesurvcl</a></code> in <span class="pkg">fishmethods</span> for alternative methods. See <code><a href="metaM.html">metaM</a></code> for empirical methods to estimate natural mortality.
</p>


<h3>Examples</h3>

<pre>
plot(catch~age,data=BrookTroutTH,pch=19)

## demonstration of formula notation
cr1 &lt;- chapmanRobson(catch~age,data=BrookTroutTH,ages2use=2:6)
summary(cr1)
summary(cr1,verbose=TRUE)
cbind(Est=coef(cr1),confint(cr1))
plot(cr1)
plot(cr1,axis.age="age")
plot(cr1,axis.age="recoded age")
summary(cr1,parm="Z")
cbind(Est=coef(cr1,parm="Z"),confint(cr1,parm="Z"))

## demonstration of excluding ages2use
cr2 &lt;- chapmanRobson(catch~age,data=BrookTroutTH,ages2use=-c(0,1))
summary(cr2)
plot(cr2)

## demonstration of ability to work with missing age classes
age &lt;- c(  2, 3, 4, 5, 7, 9,12)
ct  &lt;- c(100,92,83,71,56,35, 1)
cr3 &lt;- chapmanRobson(age,ct,4:12)
summary(cr3)
plot(cr3)

</pre>

<hr /><div style="text-align: center;">[Package <em>FSA</em> version 0.8.25 <a href="00Index.html">Index</a>]</div>
</body></html>
