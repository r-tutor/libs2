<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Hierarchical Clustering on Principle Components (HCPC)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for HCPC {FactoMineR}"><tr><td>HCPC {FactoMineR}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Hierarchical Clustering on Principle Components (HCPC)</h2>

<h3>Description</h3>

<p>Performs an agglomerative hierarchical clustering on results from a
factor analysis. It is possible to cut the tree by clicking at the
suggested (or an other) level. Results include paragons, description
of the clusters, graphics.</p>


<h3>Usage</h3>

<pre>
HCPC(res, nb.clust=0, consol=TRUE, iter.max=10, min=3, 
  max=NULL, metric="euclidean", method="ward", order=TRUE,
  graph.scale="inertia", nb.par=5, graph=TRUE, proba=0.05, 
  cluster.CA="rows",kk=Inf,description=TRUE,...)</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>res</code></td>
<td>
<p>Either the result of a factor analysis or a dataframe.</p>
</td></tr>
<tr valign="top"><td><code>nb.clust</code></td>
<td>
<p>an integer. If 0, the tree is cut at the level the user clicks
on. If -1, the tree is automatically cut at the suggested level (see
details). If a (positive) integer, the tree is cut with nb.cluters clusters.</p>
</td></tr>
<tr valign="top"><td><code>consol</code></td>
<td>
<p>a boolean. If TRUE, a k-means consolidation is performed (consolidation cannot be performed if kk is used and equals a number).</p>
</td></tr>
<tr valign="top"><td><code>iter.max</code></td>
<td>
<p>An integer. The maximum number of iterations for the consolidation.</p>
</td></tr>
<tr valign="top"><td><code>min</code></td>
<td>
<p>an integer. The least possible number of clusters suggested.</p>
</td></tr>
<tr valign="top"><td><code>max</code></td>
<td>
<p>an integer. The higher possible number of clusters suggested; by default the minimum between 10 and the number of individuals divided by 2.</p>
</td></tr>
<tr valign="top"><td><code>metric</code></td>
<td>
<p>The metric used to built the tree. See <code><a href="../../cluster/html/agnes.html">agnes</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>The method used to built the tree. See <code><a href="../../cluster/html/agnes.html">agnes</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>order</code></td>
<td>
<p>A boolean. If TRUE, clusters are ordered following their center
coordinate on the first axis.</p>
</td></tr>
<tr valign="top"><td><code>graph.scale</code></td>
<td>
<p>A character string. By default &quot;inertia&quot; and the height of the tree corresponds
to the inertia gain, else &quot;sqrt-inertia&quot; the square root of the inertia gain.</p>
</td></tr>
<tr valign="top"><td><code>nb.par</code></td>
<td>
<p>An integer. The number of edited paragons.</p>
</td></tr>
<tr valign="top"><td><code>graph</code></td>
<td>
<p>If TRUE, graphics are displayed. If FALSE, no graph are displayed.</p>
</td></tr>
<tr valign="top"><td><code>proba</code></td>
<td>
<p>The probability used to select axes and variables in
catdes (see <code><a href="catdes.html">catdes</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>cluster.CA</code></td>
<td>
<p>A string equals to &quot;rows&quot; or &quot;columns&quot; for the clustering 
of Correspondence Analysis results.</p>
</td></tr>
<tr valign="top"><td><code>kk</code></td>
<td>
<p>An integer corresponding to the number of clusters used in a Kmeans 
preprocessing before the hierarchical clustering;   the top of the hierarchical 
tree is then constructed from this partition. This is very useful if the number 
of individuals is high. Note that consolidation cannot be performed if kk is different 
from Inf and some graphics are not drawn. Inf is used by default and 
no preprocessing is done, all the graphical outputs are then given.</p>
</td></tr>
<tr valign="top"><td><code>description</code></td>
<td>
<p>boolean; if TRUE the clusters are characterized by the variables and the dimensions</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Other arguments from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first built a hierarchical tree. Then the sum of the
within-cluster inertia are calculated for each partition. The suggested
partition is the one with the higher relative loss of inertia
(i(clusters n+1)/i(cluster n)).
</p>
<p>The absolute loss of inertia (i(cluster n)-i(cluster n+1)) is plotted
with the tree.  
</p>
<p>If the ascending clustering is constructed from a data-frame with a lot of 
rows (individuals), it is possible to first perform a partition with 
kk clusters and then construct the tree from the (weighted) kk clusters. 
</p>


<h3>Value</h3>

<p>Returns a list including:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>data.clust</code></td>
<td>
<p>The original data with a supplementary column called
clust containing the partition.</p>
</td></tr>
<tr valign="top"><td><code>desc.var</code></td>
<td>
<p>The description of the classes by the variables.
See <code><a href="catdes.html">catdes</a></code> for details or <code><a href="desfreq.html">descfreq</a></code> if clustering
is performed on CA results.</p>
</td></tr>
<tr valign="top"><td><code>desc.axes</code></td>
<td>
<p>The description of the classes by the factors (axes). 
See <code><a href="catdes.html">catdes</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>call</code></td>
<td>
<p>A list or parameters and internal objects. <code>call$t</code> gives the results for the hierarchical tree; 
<code>call$bw.before.consol</code> and <code>call$bw.after.consol</code> give the between inertia before consolidation (i.e. for the clustering obtained
from the hierarchical tree) and after the consolidation with Kmeans.</p>
</td></tr>
<tr valign="top"><td><code>desc.ind</code></td>
<td>
<p>The paragons (para) and the more typical individuals
of each cluster. See details.</p>
</td></tr>
</table>
<p>Returns the tree and a barplot of the inertia gains, the individual
factor map with the tree (3D), the factor map with individuals coloured
by cluster (2D).
</p>


<h3>Author(s)</h3>

<p>Francois Husson <a href="mailto:husson@agrocampus-ouest.fr">husson@agrocampus-ouest.fr</a>, Guillaume Le Ray, Quentin Molto</p>


<h3>See Also</h3>

 <p><code><a href="plot.HCPC.html">plot.HCPC</a></code>, <code><a href="catdes.html">catdes</a></code>,<br />
<a href="https://www.youtube.com/watch?v=4XrgWmN9erg&amp;list=PLnZgp6epRBbTsZEFXi_p6W48HhNyqwxIu&amp;index=7">Video showing how to perform clustering with FactoMineR</a></p>


<h3>Examples</h3>

<pre>
## Not run: 
data(iris)
# Principal Component Analysis:
res.pca &lt;- PCA(iris[,1:4], graph=FALSE)
# Clustering, auto nb of clusters:
hc &lt;- HCPC(res.pca, nb.clust=-1)

### Construct a hierarchical tree from a partition (with 10 clusters)
### (useful when the number of individuals is very important)
hc2 &lt;- HCPC(iris[,1:4], kk=10, nb.clust=-1)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>FactoMineR</em> version 1.41 <a href="00Index.html">Index</a>]</div>
</body></html>
