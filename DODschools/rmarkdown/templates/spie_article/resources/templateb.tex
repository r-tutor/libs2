\documentclass[12pt]{spieman}  % 12pt font required by SPIE;
%\documentclass[a4paper,12pt]{spieman}  % use this instead for A4 paper
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{graphicx}
\usepackage{setspace}
\usepackage{tocloft}
\bibliographystyle{spiejour}
\def\code{}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{color}
\definecolor{myblue}{rgb}{0,0,0.6}
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
$if(listings)$
\usepackage{listings}
\lstset{ %
  backgroundcolor=\color{mygray},  % choose the background color
  basicstyle=\bf\normalsize,        % size of fonts used for the code
  breaklines=true,                 % automatic line breaking only at whitespace
  captionpos=b,                   % sets the caption-position to bottom
  commentstyle=\color{myblue},    % comment style
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  lineskip=-.5pt,
  keywordstyle=\color{mygreen},       % keyword style
  stringstyle=\color{mymauve},     % string literal style
  aboveskip=\medskipamount,
  belowskip=\medskipamount,
  frame=single,
  frameround=tttt,
}
$endif$

\title{$if(title)$$title$$else$Need Title$endif$}

\author[$if(author1.affiliation)$$author1.affiliation$$endif$]{$if(author1.name)$$author1.name$$else$First Author$endif$}
\author[$if(author2.affiliation)$$author2.affiliation$$endif$]{$if(author2.name)$$author2.name$$else$Second Author$endif$}
\author[$if(author3.affiliation)$$author3.affiliation$$endif$]{$if(author3.name)$$author3.name$$else$Third Author$endif$}
\author[$if(author4.affiliation)$$author4.affiliation$$endif$]{$if(author4.name)$$author4.name$$else$Fourth Author$endif$}

\affil[a]{$if(affil1)$$affil1$$else$$endif$}
$if(affil2)$
\affil[b]{$if(affil2)$$affil2$$else$$endif$}
$else$$endif$
$if(affil3)$
\affil[c]{$if(affil3)$$affil3$$else$$endif$}
$else$$endif$
$if(affil4)$
\affil[d]{$if(affil4)$$affil4$$else$$endif$}
$else$$endif$

\renewcommand{\cftdotsep}{\cftnodots}
\cftpagenumbersoff{figure}
\cftpagenumbersoff{table} 
\begin{document} 
\maketitle

\begin{abstract}
$if(abstract)$$abstract$$else$Need Abstract$endif$
\end{abstract}

% Include a list of up to six keywords after the abstract
\keywords{$if(keywords)$$keywords$$else$Need Keywords$endif$}

% Include email contact information for corresponding author
{\noindent \footnotesize\textbf{*}
$if(author1.contact)$$author1.name$$else$$endif$\linkable{$if(author1.contact)$$author1.contact$$else$$endif$}
$if(author2.contact)$$author2.name$$else$$endif$\linkable{$if(author2.contact)$$author2.contact$$else$$endif$}
$if(author3.contact)$$author3.name$$else$$endif$\linkable{$if(author3.contact)$$author3.contact$$else$$endif$}
$if(author4.contact)$$author4.name$$else$$endif$\linkable{$if(author4.contact)$$author4.contact$$else$$endif$} }

\begin{spacing}{2}   % use double spacing for rest of manuscript
$body$
\end{spacing}
\end{document}