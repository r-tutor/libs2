<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Google Geo Map with R</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for gvisGeoMap {googleVis}"><tr><td>gvisGeoMap {googleVis}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Google Geo Map with R 

</h2>

<h3>Description</h3>

<p>The gvisGeoMap function reads a data.frame and
creates text output referring to the Google Visualisation API, which can be
included into a web page, or as a stand-alone page.
</p>
<p>A geo map is a map of a country, continent, or region map, with colours
and values assigned to specific regions. Values are displayed as a colour
scale, and you can specify optional hover-text for regions. The map is
rendered in the browser. Note that the
map is not scroll-able or drag-gable, but can be configured to allow
zooming.
</p>


<h3>Usage</h3>

<pre>
gvisGeoMap(data, locationvar = "", numvar = "", hovervar = "",
  options = list(), chartid)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
<p><code>data.frame</code>. The data has to have at least two
columns with location name (<code>locationvar</code>), value to be mapped
to location (<code>numvar</code>) and an optional variable to display any
text while the mouse hovers over the location (<code>hovervar</code>).</p>
</td></tr>
<tr valign="top"><td><code>locationvar</code></td>
<td>
<p>column name of <code>data</code> with the geo locations to be
analysed. The locations can be provide in two formats:
</p>
      
<dl>
<dt>Format 1</dt><dd><p>'latitude:longitude'. See the example below.</p>
</dd>
<dt>Format 2</dt><dd><p>Address, country name, region name locations, or
US metropolitan area codes, see
<a href="https://developers.google.com/adwords/api/docs/appendix/geotargeting?csw=1">https://developers.google.com/adwords/api/docs/appendix/geotargeting?csw=1</a>. 
This format works with the <code>dataMode</code> option set to either
'markers' or 'regions'. The following formats are accepted: 
A specific address (for example, &quot;1600 Pennsylvania Ave&quot;). 
A country name as a string (for example, &quot;England&quot;), or an uppercase ISO-3166 code
or its English text equivalent (for example, &quot;GB&quot; or &quot;United Kingdom&quot;).
An uppercase ISO-3166-2 region code name or its English text
equivalent (for example, &quot;US-NJ&quot; or &quot;New Jersey&quot;). 
</p>
</dd>
</dl>
</td></tr>
<tr valign="top"><td><code>numvar</code></td>
<td>
<p>column name of <code>data</code> with the numeric value
displayed when the user hovers over this region.</p>
</td></tr>
<tr valign="top"><td><code>hovervar</code></td>
<td>
<p>column name of <code>data</code> with the additional string
text displayed when the user hovers over this region.</p>
</td></tr>
<tr valign="top"><td><code>options</code></td>
<td>
<p>list of configuration options.
The options are documented in detail by Google online:
</p>

<p><a href="https://google-developers.appspot.com/chart/interactive/docs/gallery/geomap#Configuration_Options">https://google-developers.appspot.com/chart/interactive/docs/gallery/geomap#Configuration_Options</a></p>

<p>The parameters can be set via a named list. The parameters have to map those
of the Google documentation. 
</p>

<ul>
<li><p>Boolean arguments are set to 
either <code>TRUE</code> or <code>FALSE</code>, using the R syntax.

</p>
</li>
<li><p>Google API parameters with a single value and with names that don't 
include a &quot;.&quot; are set like one would do in R, that is 
<code>options=list(width=200, height=300)</code>. 
Exceptions to this rule are the width and height options for 
<code><a href="gvisAnnotatedTimeLine.html">gvisAnnotatedTimeLine</a></code> and <code><a href="gvisAnnotationChart.html">gvisAnnotationChart</a></code>.
For those two functions, width and height must be character strings of the 
format <code>"Xpx"</code>, where <code>X</code> is a number, or <code>"automatic"</code>. 
For example, 
<code>options=list(width="200px", height="300px")</code>.

</p>
</li>
<li><p>Google API parameters with names that don't include a &quot;.&quot;, but require 
multivalues are set as a character, wrapped in &quot;[ ]&quot; and separated by commas, 
e.g. 

<code>options=list(colors="['#cbb69d', '#603913', '#c69c6e']")</code>

</p>
</li>
<li><p>Google API parameters with names that do include a &quot;.&quot; present parameters with 
several sub-options and have to be set as a character wrapped in &quot; &quot;.
The values of those sub-options are set via parameter:value. Boolean values
have to be stated as <code>'true'</code> or <code>'false'</code>. 
For example the Google documentaion states the formating options for the 
vertical axis and states the parameter as <code>vAxis.format</code>. 
Then this paramter can be set in R as:

<code>options=list(vAxis="{format:'#,###%'}")</code>. 

</p>
</li>
<li><p>If several sub-options have to be set, e.g. 

<code>titleTextStyle.color</code>, <code>titleTextStyle.fontName</code> and 
<code>titleTextStyle.fontSize</code>, then those can be combined in one list item 
such as:

<code>options=list(titleTextStyle="{color:'red', fontName:'Courier', fontSize:16}")</code>

</p>
</li>
<li><p>paramters that can have more than one value per sub-options are 
wrapped in &quot;[ ]&quot;. For example to set the labels for left and right axes use:

<code>options=list(vAxes="[{title:'val1'}, {title:'val2'}]")</code>

</p>
</li>
<li><p><code>gvis.editor</code> a character label for an
 on-page button that opens an in-page dialog box enabling
users to edit, change and customise the chart. By default no
value is given and therefore no button is displayed. 

</p>
</li></ul>

<p>For more details see the Google API documentation and the R examples below.   </p>
</td></tr>
<tr valign="top"><td><code>chartid</code></td>
<td>
<p>character. If missing (default) a random chart id will be 
generated based on chart type and <code><a href="../../base/html/tempfile.html">tempfile</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>gvisGeoMap returns list 
of <code><a href="../../base/html/class.html">class</a></code>
&quot;<code>gvis</code>&quot; and &quot;<code>list</code>&quot;.   
An object of class &quot;<code>gvis</code>&quot; is a list containing at least the
following components:
</p>

<dl>
<dt><code>type</code></dt><dd><p>Google visualisation type</p>
</dd>
<dt><code>chartid</code></dt><dd><p>character id of the chart object. Unique chart
ids are required to place several charts on the same page.
</p>
</dd>
<dt><code>html</code></dt><dd><p>a list with the building blocks for a page
</p>

<dl>
<dt><code>header</code></dt><dd><p>a character string of a html page header:
<code>&lt;html&gt;...&lt;body&gt;</code>,</p>
</dd>
<dt><code>chart</code></dt><dd><p>a named character vector of the chart's building blocks:
</p>

<dl>
<dt><code>jsHeader</code></dt><dd><p>Opening <code>&lt;script&gt;</code> tag and
reference to Google's JavaScript library.
</p>
</dd>
<dt><code>jsData</code></dt><dd><p>JavaScript function defining the input
<code>data</code> as a JSON object.
</p>
</dd> 
<dt><code>jsDrawChart</code></dt><dd><p>JavaScript function combing the data with 
the visualisation API and user options.
</p>
</dd>
<dt><code>jsDisplayChart</code></dt><dd><p>JavaScript function calling the
handler to display the chart.
</p>
</dd>
<dt><code>jsFooter</code></dt><dd><p>End tag <code>&lt;/script&gt;</code>.
</p>
</dd>
<dt><code>jsChart</code></dt><dd><p>Call of the <code>jsDisplayChart</code> function.
</p>
</dd>
<dt><code>divChart</code></dt><dd><p><code>&lt;div&gt;</code> container to embed the chart
into the page.
</p>
</dd>
</dl>
   
</dd>
<dt><code>caption</code></dt><dd><p>character string of a standard caption,
including data name and chart id.
</p>
</dd>  
<dt><code>footer</code></dt><dd><p>character string of a html page footer:
<code>&lt;/body&gt;...&lt;/html&gt;</code>, including the used R and googleVis version
and link to Google's Terms of Use.</p>
</dd>
</dl>
</dd>
</dl>



<h3>Warnings</h3>

<p>GeoMap (gvisGeoMap) is Flash based, conisder using GeoChart (gvisGeoChart) instead.
For more details visit: goo.gl/tkiEV8
</p>
<p>Because of Flash security settings the chart 
might not work correctly when accessed from a file location in the 
browser (e.g., file:///c:/webhost/myhost/myviz.html) rather than 
from a web server URL (e.g. https://www.myhost.com/myviz.html). 
See the googleVis package vignette and the Macromedia web 
site (<a href="https://www.macromedia.com/support/documentation/en/flashplayer/help/">https://www.macromedia.com/support/documentation/en/flashplayer/help/</a>) 
for more details.
</p>


<h3>Author(s)</h3>

<p>Markus Gesmann <a href="mailto:markus.gesmann@gmail.com">markus.gesmann@gmail.com</a>, 
Diego de Castillo <a href="mailto:decastillo@gmail.com">decastillo@gmail.com</a>
</p>


<h3>References</h3>

<p>Google Chart Tools API: 
<a href="https://google-developers.appspot.com/chart/interactive/docs/gallery/geomap">https://google-developers.appspot.com/chart/interactive/docs/gallery/geomap</a></p>




<h3>Examples</h3>

<pre>
## Please note that by default the googleVis plot command
## will open a browser window and requires Internet
## connection to display the visualisation.

## Regions Example
## The regions style fills entire regions (typically countries) with colors
## corresponding to the values that you assign. Specify the regions style
## by assigning options['dataMode'] = 'regions' in your code.

G1 &lt;- gvisGeoMap(Exports, locationvar='Country', numvar='Profit',
                 options=list(dataMode="regions")) 

plot(G1)

## Markers Example
## The "markers" style displays a circle, sized and colored to indicate
## a value, over the regions that you specify. 
G2 &lt;- gvisGeoMap(CityPopularity, locationvar='City', numvar='Popularity',
                 options=list(region='US', height=350, 
                              dataMode='markers',
                              colors='[0xFF8747, 0xFFB581, 0xc06000]'))  

plot(G2) 

## Example showing US data by state 

require(datasets)
states &lt;- data.frame(state.name, state.x77)

G3 &lt;- gvisGeoMap(states, "state.name", "Illiteracy",
                 options=list(region="US", dataMode="regions",
                              width=600, height=400))
plot(G3) 

## Example with latitude and longitude information
## Show Hurricane Andrew (1992) storm track
G4 &lt;- gvisGeoMap(Andrew, locationvar="LatLong", numvar="Speed_kt", 
                 hovervar="Category", 
                 options=list(height=350, region="US", dataMode="markers"))

plot(G4) 

## World population
WorldPopulation=data.frame(Country=Population$Country, 
                           Population.in.millions=round(Population$Population/1e6,0),
                           Rank=paste(Population$Country, "Rank:", Population$Rank))

G5 &lt;- gvisGeoMap(WorldPopulation, "Country", "Population.in.millions", "Rank", 
                 options=list(dataMode="regions", width=600, height=300))
plot(G5)

</pre>

<hr /><div style="text-align: center;">[Package <em>googleVis</em> version 0.6.4 <a href="00Index.html">Index</a>]</div>
</body></html>
