<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: The Logarithmic Distribution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for Logarithmic {actuar}"><tr><td>Logarithmic {actuar}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>The Logarithmic Distribution</h2>

<h3>Description</h3>

<p>Density function, distribution function, quantile function and random
generation for the Logarithmic (or log-series) distribution with parameter
<code>prob</code>.
</p>


<h3>Usage</h3>

<pre>
dlogarithmic(x, prob, log = FALSE)
plogarithmic(q, prob, lower.tail = TRUE, log.p = FALSE)
qlogarithmic(p, prob, lower.tail = TRUE, log.p = FALSE)
rlogarithmic(n, prob)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>vector of (strictly positive integer) quantiles.</p>
</td></tr>
<tr valign="top"><td><code>q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr valign="top"><td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p>
</td></tr>
<tr valign="top"><td><code>prob</code></td>
<td>
<p>parameter. <code>0 &lt;= prob &lt; 1</code>.</p>
</td></tr>
<tr valign="top"><td><code>log, log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities
<i>p</i> are returned as <i>log(p)</i>.</p>
</td></tr>
<tr valign="top"><td><code>lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), probabilities are
<i>P[X &le; x]</i>, otherwise, <i>P[X &gt; x]</i>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The logarithmic (or log-series) distribution with parameter
<code>prob</code> <i>= p</i> has probability mass function
</p>
<p style="text-align: center;"><i>
    p(x) = a p^x / x,</i></p>

<p>with <i>a = -1/log(1-p)</i> and for <i>x =
    1, 2, &hellip;</i>, <i>0 &le; p &lt; 1</i>.
</p>
<p>The logarithmic distribution is the limiting case of the
zero-truncated negative binomial distribution with <code>size</code>
parameter equal to <i>0</i>. Note that in this context, parameter
<code>prob</code> generally corresponds to the probability of <em>failure</em>
of the zero-truncated negative binomial.
</p>
<p>If an element of <code>x</code> is not integer, the result of
<code>dlogarithmic</code> is zero, with a warning.
</p>
<p>The quantile is defined as the smallest value <i>x</i> such that
<i>F(x) &ge; p</i>, where <i>F</i> is the distribution function.
</p>


<h3>Value</h3>

<p><code>dlogarithmic</code> gives the probability mass function,
<code>plogarithmic</code> gives the distribution function,
<code>qlogarithmic</code> gives the quantile function, and
<code>rlogarithmic</code> generates random deviates.
</p>
<p>Invalid <code>prob</code> will result in return value <code>NaN</code>, with a warning.
</p>
<p>The length of the result is determined by <code>n</code> for
<code>rlogarithmic</code>, and is the maximum of the lengths of the
numerical arguments for the other functions.
</p>


<h3>Note</h3>

<p><code>qlogarithmic</code> is based on <code>qbinom</code> et al.; it uses the
Cornish&ndash;Fisher Expansion to include a skewness correction to a normal
approximation, followed by a search.
</p>
<p><code>rlogarithmic</code> is an implementation of the LS and LK algorithms
of Kemp (1981) with automatic selection. As suggested by Devroye
(1986), the LS algorithm is used when <code>prob &lt; 0.95</code>, and the LK
algorithm otherwise.
</p>


<h3>Author(s)</h3>

<p>Vincent Goulet <a href="mailto:vincent.goulet@act.ulaval.ca">vincent.goulet@act.ulaval.ca</a>
</p>


<h3>References</h3>

<p>Johnson, N. L., Kemp, A. W. and Kotz, S. (2005), <em>Univariate
Discrete Distributions, Third Edition</em>, Wiley.
</p>
<p>Klugman, S. A., Panjer, H. H. and Willmot, G. E. (2012),
<em>Loss Models, From Data to Decisions, Fourth Edition</em>, Wiley.
</p>
<p>Kemp, A. W. (1981), &ldquo;Efficient Generation of Logarithmically
Distributed Pseudo-Random Variables&rdquo;, <em>Journal of the Royal
Statistical Society, Series C</em>, vol. 30, p. 249-253.
<a href="http://www.jstor.org/stable/2346348">http://www.jstor.org/stable/2346348</a>
</p>
<p>Devroye, L. (1986), <em>Non-Uniform Random Variate Generation</em>,
Springer-Verlag. <a href="http://luc.devroye.org/rnbookindex.html">http://luc.devroye.org/rnbookindex.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="ZeroTruncatedNegativeBinomial.html">dztnbinom</a></code> for the zero-truncated negative binomial
distribution.
</p>


<h3>Examples</h3>

<pre>
## Table 1 of Kemp (1981) [also found in Johnson et al. (2005), chapter 7]
p &lt;- c(0.1, 0.3, 0.5, 0.7, 0.8, 0.85, 0.9, 0.95, 0.99, 0.995, 0.999, 0.9999)
round(rbind(dlogarithmic(1, p),
            dlogarithmic(2, p),
            plogarithmic(9, p, lower.tail = FALSE),
            -p/((1 - p) * log(1 - p))), 2)

qlogarithmic(plogarithmic(1:10, 0.9), 0.9)

x &lt;- rlogarithmic(1000, 0.8)
y &lt;- sort(unique(x))
plot(y, table(x)/length(x), type = "h", lwd = 2,
     pch = 19, col = "black", xlab = "x", ylab = "p(x)",
     main = "Empirical vs theoretical probabilities")
points(y, dlogarithmic(y, prob = 0.8),
       pch = 19, col = "red")
legend("topright", c("empirical", "theoretical"),
       lty = c(1, NA), pch = c(NA, 19), col = c("black", "red"))
</pre>

<hr /><div style="text-align: center;">[Package <em>actuar</em> version 2.3-3 <a href="00Index.html">Index</a>]</div>
</body></html>
