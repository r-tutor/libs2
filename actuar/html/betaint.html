<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: The &quot;Beta Integral&quot;</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for betaint {actuar}"><tr><td>betaint {actuar}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>The &ldquo;Beta Integral&rdquo;</h2>

<h3>Description</h3>

<p>The &ldquo;beta integral&rdquo; which is just a multiple of the non
regularized incomplete beta function. This function merely
provides an R interface to the C level routine. It is not exported
by the package.
</p>


<h3>Usage</h3>

<pre>
betaint(x, a, b)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr valign="top"><td><code>a, b</code></td>
<td>
<p>parameters. See Details for admissible values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>betaint</code> computes the &ldquo;beta integral&rdquo;
</p>
<p style="text-align: center;"><i>
    B(a, b; x) = Gamma(a + b) int_0^x t^(a-1) (1-t)^(b-1) dt</i></p>

<p>for <i>a &gt; 0</i>, <i>b != -1, -2, &hellip;</i> and
<i>0 &lt; x &lt; 1</i>.
(Here <i>Gamma(a)</i> is the function implemented
by <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s <code><a href="../../base/html/Special.html">gamma</a>()</code> and defined in its help.)
When <i>b &gt; 0</i>,
</p>
<p style="text-align: center;"><i>
    B(a, b; x) = &Gamma;(a) &Gamma;(b) I_x(a, b),</i></p>

<p>where <i>I_x(a, b)</i> is <code>pbeta(x, a, b)</code>. When <i>b &lt; 0</i>,
<i>b != -1, -2, &hellip;</i>, and <i>a &gt; 1 + floor(-b)</i>,
</p>
<p style="text-align: center;"><i>
    B(a, b; x)
    = -Gamma(a+b) {(x^(a-1) (1-x)^b)/b
        + [(a-1) x^(a-2) (1-x)^(b+1)]/[b(b+1)]
        + &hellip;
	+ [(a-1)&hellip;(a-r) x^(a-r-1) (1-x)^(b+r)]/[b(b+1)&hellip;(b+r)]}
      + [(a-1)&hellip;(a-r-1)]/[b(b+1)&hellip;(b+r)] Gamma(a-r-1)
        * Gamma(b+r+1) I_x(a-r-1, b+r+1),</i></p>

<p>where <i>r = floor(-b)</i>.
</p>
<p>This function is used (at the C level) to compute the
limited expected value for distributions of the transformed beta
family; see, for example, <code><a href="TransformedBeta.html">levtrbeta</a></code>.
</p>


<h3>Value</h3>

<p>The value of the integral.
</p>
<p>Invalid arguments will result in return value <code>NaN</code>, with a warning.
</p>


<h3>Note</h3>

<p>The need for this function in the package is well explained in the
introduction of Appendix A of Klugman et al. (2012). See also chapter
6 and 15 of Abramowitz and Stegun (1972) for definitions and relations
to the hypergeometric series.
</p>


<h3>Author(s)</h3>

<p>Vincent Goulet <a href="mailto:vincent.goulet@act.ulaval.ca">vincent.goulet@act.ulaval.ca</a>
</p>


<h3>References</h3>

<p>Abramowitz, M. and Stegun, I. A. (1972), <em>Handbook of Mathematical
Functions</em>, Dover.
</p>
<p>Klugman, S. A., Panjer, H. H. and Willmot, G. E. (2012),
<em>Loss Models, From Data to Decisions, Fourth Edition</em>, Wiley.
</p>


<h3>Examples</h3>

<pre>
x &lt;- 0.3
a &lt;- 7

## case with b &gt; 0
b &lt;- 2
actuar:::betaint(x, a, b)
gamma(a) * gamma(b) * pbeta(x, a, b)    # same

## case with b &lt; 0
b &lt;- -2.2
r &lt;- floor(-b)        # r = 2
actuar:::betaint(x, a, b)

## "manual" calculation
s &lt;- (x^(a-1) * (1-x)^b)/b +
    ((a-1) * x^(a-2) * (1-x)^(b+1))/(b * (b+1)) +
    ((a-1) * (a-2) * x^(a-3) * (1-x)^(b+2))/(b * (b+1) * (b+2))
-gamma(a+b) * s +
    (a-1)*(a-2)*(a-3) * gamma(a-r-1)/(b*(b+1)*(b+2)) *
    gamma(b+r+1)*pbeta(x, a-r-1, b+r+1)
</pre>

<hr /><div style="text-align: center;">[Package <em>actuar</em> version 2.3-3 <a href="00Index.html">Index</a>]</div>
</body></html>
