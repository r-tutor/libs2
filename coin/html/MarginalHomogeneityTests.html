<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Marginal Homogeneity Tests</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for MarginalHomogeneityTests {coin}"><tr><td>MarginalHomogeneityTests {coin}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Marginal Homogeneity Tests</h2>

<h3>Description</h3>

<p>Testing the marginal homogeneity of a repeated measurements factor in a
complete block design.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'formula'
mh_test(formula, data, subset = NULL, ...)
## S3 method for class 'table'
mh_test(object, ...)
## S3 method for class 'SymmetryProblem'
mh_test(object, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>

<p>a formula of the form <code>y ~ x | block</code> where <code>y</code> and <code>x</code> are
factors and <code>block</code> is an optional factor (which is generated
automatically if omitted).
</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>

<p>an optional data frame containing the variables in the model formula.
</p>
</td></tr>
<tr valign="top"><td><code>subset</code></td>
<td>

<p>an optional vector specifying a subset of observations to be used.  Defaults
to <code>NULL</code>.
</p>
</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>

<p>an object inheriting from classes <code>"table"</code> (with identical
<code>dimnames</code> components) or <code>"<a href="SymmetryProblem-class.html">SymmetryProblem</a>"</code>.
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>

<p>further arguments to be passed to <code><a href="SymmetryTest.html">symmetry_test</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mh_test</code> provides the McNemar test, the Cochran <i>Q</i> test, the
Stuart(-Maxwell) test and the Madansky test of interchangeability.  A general
description of these methods is given by Agresti (2002).
</p>
<p>The null hypothesis of marginal homogeneity is tested.  The response variable
and the measurement conditions are given by <code>y</code> and <code>x</code>,
respectively, and <code>block</code> is a factor where each level corresponds to
exactly one subject with repeated measurements.
</p>
<p>This procedure is known as the McNemar test (McNemar, 1947) when both <code>y</code>
and <code>x</code> are binary factors, as the Cochran <i>Q</i> test (Cochran, 1950)
when <code>y</code> is a binary factor and <code>x</code> is a factor with an arbitrary
number of levels, as the Stuart(-Maxwell) test (Stuart, 1955; Maxwell, 1970)
when <code>y</code> is a factor with an arbitrary number of levels and <code>x</code> is a
binary factor, and as the Madansky test of interchangeability (Madansky, 1963),
which implies marginal homogeneity, when both <code>y</code> and <code>x</code> are
factors with an arbitrary number of levels.




</p>
<p>If <code>y</code> and/or <code>x</code> are ordered factors, the default scores,
<code>1:nlevels(y)</code> and <code>1:nlevels(x)</code> respectively, can be altered using
the <code>scores</code> argument (see <code><a href="SymmetryTest.html">symmetry_test</a></code>); this argument
can also be used to coerce nominal factors to class <code>"ordered"</code>.  If both
<code>y</code> and <code>x</code> are ordered factors, a linear-by-linear association test
is computed and the direction of the alternative hypothesis can be specified
using the <code>alternative</code> argument.  This extension was given by Birch
(1965) who also discussed the situation when either the response or the
measurement condition is an ordered factor; see also White, Landis and Cooper
(1982).
</p>
<p>The conditional null distribution of the test statistic is used to obtain
<i>p</i>-values and an asymptotic approximation of the exact distribution is
used by default (<code>distribution = "asymptotic"</code>).  Alternatively, the
distribution can be approximated via Monte Carlo resampling or computed
exactly for univariate two-sample problems by setting <code>distribution</code> to
<code>"approximate"</code> or <code>"exact"</code> respectively.  See
<code><a href="NullDistribution.html">asymptotic</a></code>, <code><a href="NullDistribution.html">approximate</a></code> and <code><a href="NullDistribution.html">exact</a></code>
for details.
</p>


<h3>Value</h3>

<p>An object inheriting from class <code>"<a href="IndependenceTest-class.html">IndependenceTest</a>"</code>.
</p>


<h3>Note</h3>

<p>This function is currently computationally inefficient for data with a large
number of pairs or sets.
</p>


<h3>References</h3>

<p>Agresti, A.  (2002).  <em>Categorical Data Analysis</em>, Second Edition.
Hoboken, New Jersey: John Wiley &amp; Sons.
</p>



<p>Birch, M. W.  (1965).  The detection of partial association, II: The general
case.  <em>Journal of the Royal Statistical Society</em> B <b>27</b>(1),
111&ndash;124.  doi: <a href="https://doi.org/10.1111/j.2517-6161.1965.tb00593.x">10.1111/j.2517-6161.1965.tb00593.x</a>
</p>
<p>Cochran, W. G.  (1950).  The comparison of percentages in matched
samples.  <em>Biometrika</em> <b>37</b>(3/4), 256&ndash;266.
doi: <a href="https://doi.org/10.1093/biomet/37.3-4.256">10.1093/biomet/37.3-4.256</a>
</p>




<p>Madansky, A.  (1963).  Tests of homogeneity for correlated samples.
<em>Journal of the American Statistical Association</em> <b>58</b>(301),
97&ndash;119.  doi: <a href="https://doi.org/10.1080/01621459.1963.10500835">10.1080/01621459.1963.10500835</a>
</p>
<p>Maxwell, A. E.  (1970).  Comparing the classification of subjects by two
independent judges.  <em>British Journal of Psychiatry</em> <b>116</b>(535),
651&ndash;655.  doi: <a href="https://doi.org/10.1192/bjp.116.535.651">10.1192/bjp.116.535.651</a>
</p>
<p>McNemar, Q.  (1947).  Note on the sampling error of the difference between
correlated proportions or percentages.  <em>Psychometrika</em> <b>12</b>(2),
153&ndash;157.  doi: <a href="https://doi.org/10.1007/BF02295996">10.1007/BF02295996</a>
</p>
<p>Stuart, A.  (1955).  A test for homogeneity of the marginal distributions in a
two-way classification.  <em>Biometrika</em> <b>42</b>(3/4), 412&ndash;416.
doi: <a href="https://doi.org/10.1093/biomet/42.3-4.412">10.1093/biomet/42.3-4.412</a>
</p>
<p>White, A. A., Landis, J. R. and Cooper, M. M.  (1982).  A note on the
equivalence of several marginal homogeneity test criteria for categorical
data.  <em>International Statistical Review</em> <b>50</b>(1), 27&ndash;34.
doi: <a href="https://doi.org/10.2307/1402457">10.2307/1402457</a>
</p>


<h3>Examples</h3>

<pre>
## Performance of prime minister
## Agresti (2002, p. 409)
performance &lt;- matrix(
    c(794, 150,
       86, 570),
    nrow = 2, byrow = TRUE,
    dimnames = list(
         "First" = c("Approve", "Disprove"),
        "Second" = c("Approve", "Disprove")
    )
)
performance &lt;- as.table(performance)
diag(performance) &lt;- 0 # speed-up: only off-diagonal elements contribute

## Asymptotic McNemar Test
mh_test(performance)

## Exact McNemar Test
mh_test(performance, distribution = "exact")


## Effectiveness of different media for the growth of diphtheria
## Cochran (1950, Tab. 2)
cases &lt;- c(4, 2, 3, 1, 59)
n &lt;- sum(cases)
cochran &lt;- data.frame(
    diphtheria = factor(
        unlist(rep(list(c(1, 1, 1, 1),
                        c(1, 1, 0, 1),
                        c(0, 1, 1, 1),
                        c(0, 1, 0, 1),
                        c(0, 0, 0, 0)),
                   cases))
    ),
    media = factor(rep(LETTERS[1:4], n)),
    case =  factor(rep(seq_len(n), each = 4))
)

## Asymptotic Cochran Q test (Cochran, 1950, p. 260)
mh_test(diphtheria ~ media | case, data = cochran) # Q = 8.05

## Approximative Cochran Q test
mt &lt;- mh_test(diphtheria ~ media | case, data = cochran,
              distribution = approximate(nresample = 10000))
pvalue(mt)             # standard p-value
midpvalue(mt)          # mid-p-value
pvalue_interval(mt)    # p-value interval
size(mt, alpha = 0.05) # test size at alpha = 0.05 using the p-value


## Opinions on Pre- and Extramarital Sex
## Agresti (2002, p. 421)
opinions &lt;- c("Always wrong", "Almost always wrong",
              "Wrong only sometimes", "Not wrong at all")
PreExSex &lt;- matrix(
    c(144, 33, 84, 126,
        2,  4, 14,  29,
        0,  2,  6,  25,
        0,  0,  1,   5),
    nrow = 4,
    dimnames = list(
          "Premarital Sex" = opinions,
        "Extramarital Sex" = opinions
    )
)
PreExSex &lt;- as.table(PreExSex)

## Asymptotic Stuart test
mh_test(PreExSex)

## Asymptotic Stuart-Birch test
## Note: response as ordinal
mh_test(PreExSex, scores = list(response = 1:length(opinions)))


## Vote intention
## Madansky (1963, pp. 107-108)
vote &lt;- array(
    c(120, 1,  8, 2,   2,  1, 2, 1,  7,
        6, 2,  1, 1, 103,  5, 1, 4,  8,
       20, 3, 31, 1,   6, 30, 2, 1, 81),
    dim = c(3, 3, 3),
    dimnames = list(
          "July" = c("Republican", "Democratic", "Uncertain"),
        "August" = c("Republican", "Democratic", "Uncertain"),
          "June" = c("Republican", "Democratic", "Uncertain")
    )
)
vote &lt;- as.table(vote)

## Asymptotic Madansky test (Q = 70.77)
mh_test(vote)


## Cross-over study
## http://www.nesug.org/proceedings/nesug00/st/st9005.pdf
dysmenorrhea &lt;- array(
    c(6, 2, 1,  3, 1, 0,  1, 2, 1,
      4, 3, 0, 13, 3, 0,  8, 1, 1,
      5, 2, 2, 10, 1, 0, 14, 2, 0),
    dim = c(3, 3, 3),
    dimnames =  list(
          "Placebo" = c("None", "Moderate", "Complete"),
         "Low dose" = c("None", "Moderate", "Complete"),
        "High dose" = c("None", "Moderate", "Complete")
    )
)
dysmenorrhea &lt;- as.table(dysmenorrhea)

## Asymptotic Madansky-Birch test (Q = 53.76)
## Note: response as ordinal
mh_test(dysmenorrhea, scores = list(response = 1:3))

## Asymptotic Madansky-Birch test (Q = 47.29)
## Note: response and measurement conditions as ordinal
mh_test(dysmenorrhea, scores = list(response = 1:3,
                                    conditions = 1:3))
</pre>

<hr /><div style="text-align: center;">[Package <em>coin</em> version 1.4-1 <a href="00Index.html">Index</a>]</div>
</body></html>
