<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Two- and K-Sample Scale Tests</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for ScaleTests {coin}"><tr><td>ScaleTests {coin}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Two- and <i>K</i>-Sample Scale Tests</h2>

<h3>Description</h3>

<p>Testing the equality of the distributions of a numeric response variable in
two or more independent groups against scale alternatives.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'formula'
taha_test(formula, data, subset = NULL, weights = NULL, ...)
## S3 method for class 'IndependenceProblem'
taha_test(object, conf.int = FALSE, conf.level = 0.95, ...)

## S3 method for class 'formula'
klotz_test(formula, data, subset = NULL, weights = NULL, ...)
## S3 method for class 'IndependenceProblem'
klotz_test(object, ties.method = c("mid-ranks", "average-scores"),
           conf.int = FALSE, conf.level = 0.95, ...)

## S3 method for class 'formula'
mood_test(formula, data, subset = NULL, weights = NULL, ...)
## S3 method for class 'IndependenceProblem'
mood_test(object, ties.method = c("mid-ranks", "average-scores"),
          conf.int = FALSE, conf.level = 0.95, ...)

## S3 method for class 'formula'
ansari_test(formula, data, subset = NULL, weights = NULL, ...)
## S3 method for class 'IndependenceProblem'
ansari_test(object, ties.method = c("mid-ranks", "average-scores"),
            conf.int = FALSE, conf.level = 0.95, ...)

## S3 method for class 'formula'
fligner_test(formula, data, subset = NULL, weights = NULL, ...)
## S3 method for class 'IndependenceProblem'
fligner_test(object, ties.method = c("mid-ranks", "average-scores"),
             conf.int = FALSE, conf.level = 0.95, ...)

## S3 method for class 'formula'
conover_test(formula, data, subset = NULL, weights = NULL, ...)
## S3 method for class 'IndependenceProblem'
conover_test(object, conf.int = FALSE, conf.level = 0.95, ...)

</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>

<p>a formula of the form <code>y ~ x | block</code> where <code>y</code> is a numeric
variable, <code>x</code> is a factor and <code>block</code> is an optional factor for
stratification.
</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>

<p>an optional data frame containing the variables in the model formula.
</p>
</td></tr>
<tr valign="top"><td><code>subset</code></td>
<td>

<p>an optional vector specifying a subset of observations to be used.  Defaults
to <code>NULL</code>.
</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>

<p>an optional formula of the form <code>~ w</code> defining integer valued case
weights for each observation.  Defaults to <code>NULL</code>, implying equal
weight for all observations.
</p>
</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>

<p>an object inheriting from class <code>"<a href="IndependenceProblem-class.html">IndependenceProblem</a>"</code>.
</p>
</td></tr>
<tr valign="top"><td><code>conf.int</code></td>
<td>

<p>a logical indicating whether a confidence interval for the ratio of scales
should be computed.  Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr valign="top"><td><code>conf.level</code></td>
<td>

<p>a numeric, confidence level of the interval.  Defaults to <code>0.95</code>.
</p>
</td></tr>
<tr valign="top"><td><code>ties.method</code></td>
<td>

<p>a character, the method used to handle ties: the score generating function
either uses mid-ranks (<code>"mid-ranks"</code>, default) or averages the scores
of randomly broken ties (<code>"average-scores"</code>).
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>

<p>further arguments to be passed to <code><a href="IndependenceTest.html">independence_test</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>taha_test</code>, <code>klotz_test</code>, <code>mood_test</code>, <code>ansari_test</code>,
<code>fligner_test</code> and <code>conover_test</code> provide the Taha test, the Klotz
test, the Mood test, the Ansari-Bradley test, the Fligner-Killeen test and the
Conover-Iman test.  A general description of these methods is given by
Hollander and Wolfe (1999).  For the adjustment of scores for tied
values see Hájek, Šidák and Sen (1999,
pp. 133&ndash;135).
</p>
<p>The null hypothesis of equality, or conditional equality given <code>block</code>,
of the distribution of <code>y</code> in the groups defined by <code>x</code> is tested
against scale alternatives.  In the two-sample case, the two-sided null
hypothesis is <i>H_0: V(Y_1) / V(Y_2) = 1</i>,
where <i>V(Y_s)</i> is the variance of the responses in the <i>s</i>th sample.
In case <code>alternative = "less"</code>, the null hypothesis is <i>H_0: V(Y_1) / V(Y_2) &gt;= 1</i>.  When
<code>alternative = "greater"</code>, the null hypothesis is <i>H_0: V(Y_1) / V(Y_2) &lt;= 1</i>.  Confidence intervals for the
ratio of scales are available and computed according to Bauer (1972).
</p>
<p>The Fligner-Killeen test uses median centering in each of the samples, as
suggested by Conover, Johnson and Johnson (1981), whereas the Conover-Iman
test, following Conover and Iman (1978), uses mean centering in each of the
samples.
</p>
<p>The conditional null distribution of the test statistic is used to obtain
<i>p</i>-values and an asymptotic approximation of the exact distribution is
used by default (<code>distribution = "asymptotic"</code>).  Alternatively, the
distribution can be approximated via Monte Carlo resampling or computed
exactly for univariate two-sample problems by setting <code>distribution</code> to
<code>"approximate"</code> or <code>"exact"</code> respectively.  See
<code><a href="NullDistribution.html">asymptotic</a></code>, <code><a href="NullDistribution.html">approximate</a></code> and <code><a href="NullDistribution.html">exact</a></code>
for details.
</p>


<h3>Value</h3>

<p>An object inheriting from class <code>"<a href="IndependenceTest-class.html">IndependenceTest</a>"</code>.
Confidence intervals can be extracted by <a href="../../stats/html/confint.html">confint</a>.
</p>


<h3>Note</h3>

<p>In the two-sample case, a <em>large</em> value of the Ansari-Bradley
statistic indicates that sample 1 is <em>less</em> variable than sample
2, whereas a <em>large</em> value of the statistics due to Taha, Klotz,
Mood, Fligner-Killeen, and Conover-Iman indicate that sample 1 is
<em>more</em> variable than sample 2.
</p>


<h3>References</h3>

<p>Bauer, D. F.  (1972).  Constructing confidence sets using rank statistics.
<em>Journal of the American Statistical Association</em> <b>67</b>(339),
687&ndash;690.  doi: <a href="https://doi.org/10.1080/01621459.1972.10481279">10.1080/01621459.1972.10481279</a>
</p>
<p>Conover, W. J. and Iman, R. L.  (1978).  Some exact tables for the squared
ranks test.  <em>Communications in Statistics &ndash; Simulation and Computation</em>
<b>7</b>(5), 491&ndash;513.  doi: <a href="https://doi.org/10.1080/03610917808812093">10.1080/03610917808812093</a>
</p>
<p>Conover, W. J., Johnson, M. E. and Johnson, M. M.  (1981).  A comparative
study of tests for homogeneity of variances, with applications to the outer
continental shelf bidding data.  <em>Technometrics</em> <b>23</b>(4), 351&ndash;361.
doi: <a href="https://doi.org/10.1080/00401706.1981.10487680">10.1080/00401706.1981.10487680</a>
</p>
<p>Hájek, J., Šidák, Z. and Sen, P. K.  (1999).
<em>Theory of Rank Tests</em>, Second Edition.  San Diego: Academic Press.
</p>
<p>Hollander, M. and Wolfe, D. A.  (1999).  <em>Nonparametric Statistical
Methods</em>, Second Edition.   York: John Wiley &amp; Sons.
</p>


<h3>Examples</h3>

<pre>
## Serum Iron Determination Using Hyland Control Sera
## Hollander and Wolfe (1999, p. 147, Tab 5.1)
sid &lt;- data.frame(
    serum = c(111, 107, 100, 99, 102, 106, 109, 108, 104, 99,
              101, 96, 97, 102, 107, 113, 116, 113, 110, 98,
              107, 108, 106, 98, 105, 103, 110, 105, 104,
              100, 96, 108, 103, 104, 114, 114, 113, 108, 106, 99),
    method = gl(2, 20, labels = c("Ramsay", "Jung-Parekh"))
)

## Asymptotic Ansari-Bradley test
ansari_test(serum ~ method, data = sid)

## Exact Ansari-Bradley test
pvalue(ansari_test(serum ~ method, data = sid,
                   distribution = "exact"))


## Platelet Counts of Newborn Infants
## Hollander and Wolfe (1999, p. 171, Tab. 5.4)
platelet &lt;- data.frame(
    counts = c(120, 124, 215, 90, 67, 95, 190, 180, 135, 399,
               12, 20, 112, 32, 60, 40),
    treatment = factor(rep(c("Prednisone", "Control"), c(10, 6)))
)

## Approximative (Monte Carlo) Lepage test
## Hollander and Wolfe (1999, p. 172)
lepage_trafo &lt;- function(y)
    cbind("Location" = rank_trafo(y), "Scale" = ansari_trafo(y))

independence_test(counts ~ treatment, data = platelet,
                  distribution = approximate(nresample = 10000),
                  ytrafo = function(data)
                      trafo(data, numeric_trafo = lepage_trafo),
                  teststat = "quadratic")

## Why was the null hypothesis rejected?
## Note: maximum statistic instead of quadratic form
ltm &lt;- independence_test(counts ~ treatment, data = platelet,
                         distribution = approximate(nresample = 10000),
                         ytrafo = function(data)
                             trafo(data, numeric_trafo = lepage_trafo))

## Step-down adjustment suggests a difference in location
pvalue(ltm, method = "step-down")

## The same results are obtained from the simple Sidak-Holm procedure since the
## correlation between Wilcoxon and Ansari-Bradley test statistics is zero
cov2cor(covariance(ltm))
pvalue(ltm, method = "step-down", distribution = "marginal", type = "Sidak")
</pre>

<hr /><div style="text-align: center;">[Package <em>coin</em> version 1.4-1 <a href="00Index.html">Index</a>]</div>
</body></html>
